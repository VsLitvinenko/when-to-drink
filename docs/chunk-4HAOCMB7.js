import{b as ai,c as N}from"./chunk-6IGCFAUU.js";import{a as St,b as ge,c as Xe,d as _e,e as A,f as ve,g as ri,h as U}from"./chunk-567XOYJ6.js";import{c as Dt,d as ft,e as wt,g as Ge,h as It,i as Je}from"./chunk-46S35REE.js";import{$ as Pe,$b as ii,Aa as je,Ab as Fe,B as v,Ba as Le,Bb as Qt,C as b,Ca as ce,Cb as dt,D as x,Da as re,Db as Yt,Ea as He,Fa as m,Ga as _,Gb as X,H as P,Ha as O,Hb as R,I as le,Ia as Wt,Ib as ue,Ja as qe,Jb as fe,K as Se,Kb as Gt,L as s,La as Q,Lb as Jt,Ma as Qe,Mb as Xt,Na as Ye,O as I,Oa as D,Ob as ut,Pa as Oe,Q as q,Ra as jt,S as z,Sa as Re,Sb as Kt,T as Bt,Ta as Ht,Tb as he,Ua as pe,Ub as Y,V as zt,Va as me,Wa as at,Wb as Zt,X as $,Xb as ei,Y as F,Yb as ti,Z as ke,_ as Te,_a as Be,a as W,aa as u,ac as ht,b as Et,ba as a,bc as ni,c as we,ca as l,da as y,db as qt,dc as oi,e as Vt,ea as $t,fa as Ft,g as T,ga as Ct,h as J,ha as S,i as Lt,ia as C,j as G,ja as f,jb as st,k as nt,ka as At,la as Ut,m as We,ma as bt,n as ot,na as xt,nb as lt,o as Z,oa as Mt,pa as Ee,q as Ot,qa as Ve,qb as ct,r as se,ra as M,s as ee,sa as Nt,t as w,ta as rt,u as te,ua as d,ub as de,v as V,va as g,vb as ze,w as Rt,wa as j,wb as pt,xa as ie,xb as mt,y as Ie,ya as ne,za as oe,zb as $e}from"./chunk-3L6J7R6N.js";import"./chunk-Q6FFIHTR.js";import"./chunk-7KGURMOZ.js";import"./chunk-NKG53MNX.js";import"./chunk-62TPDNO2.js";import"./chunk-7PWDY3UP.js";import"./chunk-JRYKI6H5.js";import"./chunk-GIIU5PV3.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-SPMQWSIB.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as B,b as H,f as yt}from"./chunk-2R6CW7ES.js";var si={Search:{en:"Search",ru:"\u041F\u043E\u0438\u0441\u043A"}};var Ae=(()=>{let i=class i{set src(e){e?(this.img.src=e,this.showPlaceholder()):this.img.src=this.imgPlaceholder}get img(){return this.elRef.nativeElement}constructor(){this.imgPlaceholder="/assets/no-avatar.png",this.elRef=v(le),this.placeholderEl=this.createPlaceholderEl(),this.img.onload=()=>this.hidePlaceholder()}showPlaceholder(){let e=this.placeholderEl;e.style.width=`${this.img.width+2}px`,e.style.height=`${this.img.offsetHeight+2}px`,e.style.top=`${this.img.offsetTop-1}px`,e.style.left=`${this.img.offsetLeft-1}px`,e.style.borderRadius=window.getComputedStyle(this.img).getPropertyValue("border-radius"),this.img.after(this.placeholderEl)}hidePlaceholder(){this.placeholderEl.remove()}createPlaceholderEl(){let e=document.createElement("div");return e.style.zIndex="1",e.style.position="absolute",e.className="skeleton-placeholder",e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=q({type:i,selectors:[["","appImgLoad",""]],inputs:{src:"src",imgPlaceholder:"imgPlaceholder"}});let o=i;return o})();var ye=(()=>{let i=class i{set placeholderOpacity(e){this.placeholderEl.style.opacity=e}get el(){return this.elRef.nativeElement}constructor(){this.elRef=v(le),this.placeholderEl=this.createPlaceholderEl(),this.loadingCounter$=new Et(0),this.loading$=this.loadingCounter$.pipe(T(e=>e>0),ot()),this.destroyed$=new W}ngOnInit(){this.el.style.position="relative",this.loading$.pipe(te(this.destroyed$)).subscribe(e=>e?this.onLoadStarts():this.onLoadEnds())}ngOnDestroy(){this.destroyed$.next(void 0),this.destroyed$.complete()}incrLoading(){this.loadingCounter$.next(this.loadingCounter$.value+1)}decrLoading(){this.loadingCounter$.next(this.loadingCounter$.value-1)}onLoadStarts(){this.el.appendChild(this.placeholderEl)}onLoadEnds(){this.placeholderEl.remove()}createPlaceholderEl(){let e=document.createElement("div");return e.style.zIndex="2",e.style.position="absolute",e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.pointerEvents="none",e.style.borderRadius="0.5rem",e.className="skeleton-placeholder",e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=q({type:i,selectors:[["","appFeatureLoad",""]],inputs:{placeholderOpacity:"placeholderOpacity"},exportAs:["appFeatureLoad"]});let o=i;return o})();var Ei=["altLabel"],Vi=["end"],li=(o,i)=>({$implicit:o,index:i});function Li(o,i){if(o&1&&Ct(0,6),o&2){let r=f(),e=r.$implicit,t=r.$index,n=f();u("ngTemplateOutlet",n.altLabelTemplateRef)("ngTemplateOutletContext",He(2,li,e,t))}}function Oi(o,i){if(o&1&&(a(0,"ion-label"),d(1),l()),o&2){let r=f().$implicit;s(),g(" ",r.fullName," ")}}function Ri(o,i){if(o&1&&Ct(0,6),o&2){let r=f(),e=r.$implicit,t=r.$index,n=f();u("ngTemplateOutlet",n.endTemplateRef)("ngTemplateOutletContext",He(2,li,e,t))}}function Bi(o,i){if(o&1){let r=S();a(0,"ion-item",3),C("click",function(){let t=b(r),n=t.$implicit,c=t.$index,p=f();return x(p.onUserClicked(c,n))}),a(1,"ion-avatar",4),y(2,"img",5),l(),$(3,Li,1,5,"ng-container",6)(4,Oi,2,1,"ion-label"),$(5,Ri,1,5,"ng-container",6),l()}if(o&2){let r=i.$implicit,e=i.$index,t=i.$count,n=f();u("lines",e===t-1?"none":"")("button",n.clickable()),s(2),u("src",r.photoUrl,Se),s(),F(n.altLabelTemplateRef?3:4),s(2),F(n.endTemplateRef?5:-1)}}var gt=(()=>{let i=class i{constructor(){this.clickable=D(!1),this.users=D.required(),this.searchStr=P(null),this.filteredUsers=Q(()=>{let e=this.users(),t=this.searchStr()?.toLowerCase();return t?e.filter(n=>n.fullName.toLowerCase().includes(t)):e}),this.searchFocused=Ye(),this.userClicked=Ye(),this.UsersListLocalize=si}onUserClicked(e,t){this.clickable()&&this.userClicked.emit({index:e,user:B({},t)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-users-list"]],contentQueries:function(t,n,c){if(t&1&&(bt(c,Ei,7),bt(c,Vi,7)),t&2){let p;xt(p=Mt())&&(n.altLabelTemplateRef=p.first),xt(p=Mt())&&(n.endTemplateRef=p.first)}},inputs:{clickable:[1,"clickable"],users:[1,"users"]},outputs:{searchFocused:"searchFocused",userClicked:"userClicked"},decls:5,vars:4,consts:[["mode","ios","clear-icon","close-outline",3,"ionInput","ionFocus","ionBlur","debounce","placeholder"],["mode","ios"],[3,"lines","button"],[3,"click","lines","button"],["slot","start"],["appImgLoad","",3,"src"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,n){t&1&&(a(0,"ion-searchbar",0),m(1,"localize"),C("ionInput",function(p){return n.searchStr.set(p.detail.value)})("ionFocus",function(){return n.searchFocused.emit(!0)})("ionBlur",function(){return n.searchFocused.emit(!1)}),l(),a(2,"ion-list",1),Te(3,Bi,6,5,"ion-item",2,ke),l()),t&2&&(u("debounce",300)("placeholder",_(1,2,n.UsersListLocalize.Search)),s(3),Pe(n.filteredUsers()))},dependencies:[at,Ht,A,ue,X,$e,R,ei,Ae],styles:["[_nghost-%COMP%]{height:100%;position:relative}ion-searchbar[_ngcontent-%COMP%]{position:sticky;top:0}ion-list[_ngcontent-%COMP%]{background:transparent;max-height:calc(100% - 3.75rem);overflow-y:auto}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-label[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}"]});let o=i;return o})();function zi(o,i){if(o&1&&(a(0,"ion-avatar"),y(1,"img",1),l()),o&2){let r=i.$implicit,e=i.$index,t=i.$count;Nt("z-index",t-e),s(),u("src",r.photoUrl,Se)}}var ci=(()=>{let i=class i{constructor(){this.users=D.required(),this.maxCount=D(8),this.sliced=Q(()=>this.users().slice(0,this.maxCount()))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-avatars-list"]],inputs:{users:[1,"users"],maxCount:[1,"maxCount"]},decls:2,vars:0,consts:[[3,"zIndex"],["appImgLoad","","alt","",3,"src"]],template:function(t,n){t&1&&Te(0,zi,2,3,"ion-avatar",0,ke),t&2&&Pe(n.sliced())},dependencies:[at,$e,Ae],styles:["[_nghost-%COMP%]{display:flex}ion-avatar[_ngcontent-%COMP%]{width:1.6rem;height:1.6rem}ion-avatar[_ngcontent-%COMP%]:not(:last-child){margin-right:-.7rem}"]});let o=i;return o})();var Ue={Member:{en:"member",ru:"\u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A"},Initiator:{en:"Initiator",ru:"\u0418\u043D\u0438\u0446\u0438\u0430\u0442\u043E\u0440"},Starts:{en:"Starts",ru:"\u041D\u0430\u0447\u0430\u043B\u043E"},Ends:{en:"Ends",ru:"\u041A\u043E\u043D\u0435\u0446"},Description:{en:"Description",ru:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},Refresh:{en:"Refresh",ru:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C"},Share:{en:"Share",ru:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},Link:{en:"Link",ru:"\u0421\u0441\u044B\u043B\u043A\u0430"},Edit:{en:"Edit",ru:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"},Delete:{en:"Delete",ru:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"},ClipboardLink:{en:"Link was copied to clipboard",ru:"\u0421\u0441\u044B\u043B\u043A\u0430 \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u0430 \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0435\u043D\u0430"},EventWasDeleted:{en:"Event was successfully deleted",ru:"\u0421\u043E\u0431\u044B\u0442\u0438\u0435 \u0431\u044B\u043B\u043E \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u043E"},DeleteQuestion:{en:"Delete event?",ru:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043E\u0431\u044B\u0442\u0438\u0435?"},CannotBeUndone:{en:"This cannot be undone",ru:"\u042D\u0442\u043E \u043D\u0435\u043B\u044C\u0437\u044F \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"}};var pi=(()=>{let i=class i{constructor(){this.baseUrl="events",this.http=v(Be)}getEventInfo(e){return this.http.get(`${this.baseUrl}/info/${e}`)}getEventUsers(e){return this.http.get(`${this.baseUrl}/users/${e}`)}deleteEvent(e){return this.http.delete(`${this.baseUrl}/${e}`)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ie({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var $i=()=>[0,1],mi=()=>[];function Fi(o,i){if(o&1){let r=S();a(0,"ion-item",16),C("click",function(){b(r);let t=f(2);return x(t.redirectToEdit())}),y(1,"ion-icon",20),a(2,"ion-label"),d(3),m(4,"localize"),l()(),a(5,"ion-item",16),C("click",function(){b(r);let t=f(2);return x(t.deleteEvent())}),y(6,"ion-icon",21),a(7,"ion-label",22),d(8),m(9,"localize"),l()()}if(o&2){let r=f(2);u("detail",!1),s(3),g(" ",_(4,4,r.EventMainInfoLocalize.Edit)," "),s(2),u("detail",!1),s(3),g(" ",_(9,6,r.EventMainInfoLocalize.Delete)," ")}}function Ai(o,i){if(o&1){let r=S();a(0,"ion-list",15)(1,"ion-item",16),C("click",function(){b(r);let t=f();return t.refreshInfo(),x(t.refreshUsers())}),y(2,"ion-icon",17),a(3,"ion-label"),d(4),m(5,"localize"),l()(),a(6,"ion-item",16),C("click",function(){b(r);let t=f();return x(t.share())}),y(7,"ion-icon",18),a(8,"ion-label"),d(9),m(10,"localize"),l()(),a(11,"ion-item",16),C("click",function(){b(r);let t=f();return x(t.copyToClipboard())}),y(12,"ion-icon",19),a(13,"ion-label"),d(14),m(15,"localize"),l()(),$(16,Fi,10,8),l()}if(o&2){let r=f(),e=ce(0);s(),u("detail",!1),s(3),g(" ",_(5,7,r.EventMainInfoLocalize.Refresh)," "),s(2),u("detail",!1),s(3),g(" ",_(10,9,r.EventMainInfoLocalize.Share)," "),s(2),u("detail",!1),s(3),g(" ",_(15,11,r.EventMainInfoLocalize.Link)," "),s(2),F(e!=null&&e.canEdit?16:-1)}}function Ui(o,i){if(o&1){let r=S();a(0,"ion-item",16),C("click",function(){b(r),f();let t=M(38);return x(t.present())}),a(1,"ion-label"),d(2),m(3,"localizeMany"),l(),y(4,"app-avatars-list",23),l()}if(o&2){let r=f(),e=ce(1),t=ce(14);u("detail",!1),s(2),j(" ",t," ",O(3,4,r.EventMainInfoLocalize.Member,t)," "),s(2),u("users",e??re(7,mi))}}function Ni(o,i){if(o&1&&(a(0,"ion-item",13)(1,"ion-label"),d(2),m(3,"localize"),l(),a(4,"ion-note"),d(5),l()()),o&2){let r=f(),e=ce(0);s(2),g(" ",_(3,2,r.EventMainInfoLocalize.Description)," "),s(3),g(" ",e==null?null:e.description," ")}}function Wi(o,i){if(o&1&&(a(0,"ion-note",26),d(1),l()),o&2){let r=f().$implicit;s(),g(" ","@"+r.username," ")}}function ji(o,i){if(o&1&&z(0,Wi,2,1,"ion-note",25),o&2){let r=i.$implicit;u("ngIf",r.username)}}function Hi(o,i){if(o&1){let r=S();a(0,"app-users-list",24),C("searchFocused",function(t){b(r),f();let n=M(38);return x(n.backdropDismiss=!t)}),z(1,ji,1,1,"ng-template",null,1,qe),l()}if(o&2){f();let r=ce(1);u("users",r??re(1,mi))}}var _t=(()=>{let i=class i{constructor(){this.eventId=D.required(),this.eventId$=ge(this.eventId),this.router=v(qt),this.toast=v(ht),this.confirm=v(oi),this.tg=v(ni),this.request=v(pi),this.featureLoad=v(ye,{optional:!0}),this.refreshInfo$=new W,this.refreshUsers$=new W,this.info$=this.refreshInfo$.pipe(ee(!0),w(()=>this.eventId$),V(()=>this.featureLoad?.incrLoading()),w(e=>this.request.getEventInfo(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),se(1)),this.users$=this.refreshUsers$.pipe(ee(!0),w(()=>this.eventId$),V(()=>this.featureLoad?.incrLoading()),w(e=>this.request.getEventUsers(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),se(1)),this.info=Xe(this.info$),this.users=Xe(this.users$),this.local=v(_e),this.EventMainInfoLocalize=Ue}refreshInfo(){this.refreshInfo$.next(!0)}refreshUsers(){this.refreshUsers$.next(!0)}copyToClipboard(){this.tg.getEventTgLink(this.eventId()).pipe(w(e=>Vt(navigator.clipboard.writeText(e))),We(1)).subscribe(()=>{let e=this.local.localizeSync(Ue.ClipboardLink);this.toast.light(e,"clipboard-outline")})}share(){this.eventId()&&this.tg.shareEvent(this.eventId(),this.info()?.name)}redirectToEdit(){let e={eventId:this.eventId()};this.router.navigate(["edit"],{queryParams:e})}deleteEvent(){let e=this.local.localizeSync(Ue.DeleteQuestion),t=this.local.localizeSync(Ue.CannotBeUndone),n=this.local.localizeSync(Ue.EventWasDeleted);this.confirm.createConfirm({header:e,message:t}).pipe(nt(Boolean),V(()=>this.featureLoad?.incrLoading()),w(()=>this.request.deleteEvent(this.eventId())),V(()=>this.toast.info(n,"trash-outline")),Z(()=>this.featureLoad?.decrLoading())).subscribe(()=>this.router.navigate(["edit"]))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-event-main-info"]],inputs:{eventId:[1,"eventId"]},decls:40,vars:31,consts:[["usersModal",""],["end",""],["mode","ios"],["value","info"],["slot","header",1,"header-item"],["slot","start"],["appImgLoad","",3,"src"],["id","menu-popover-trigger","slot","end","color","dark","fill","clear","size","large",1,"menu-button",3,"click"],["name","ellipsis-vertical","slot","icon-only"],["mode","ios","trigger","menu-popover-trigger","triggerAction","click",3,"dismissOnSelect","arrow"],["slot","content","mode","ios",1,"info-list"],["button","",3,"detail"],[3,"lines"],["lines","none",1,"notes-item"],[3,"initialBreakpoint","breakpoints"],["lines","none",1,"popover-menu-list"],["button","",3,"click","detail"],["name","refresh-outline","slot","start","color","medium"],["name","share-social-outline","slot","start","color","medium"],["name","link-outline","slot","start","color","medium"],["name","create-outline","slot","start","color","medium"],["name","trash-outline","slot","start","color","danger"],["color","danger"],[3,"users"],[3,"searchFocused","users"],["class","username",4,"ngIf"],[1,"username"]],template:function(t,n){if(t&1){let c=S();je(0)(1),a(2,"ion-accordion-group",2)(3,"ion-accordion",3)(4,"ion-item",4)(5,"ion-avatar",5),y(6,"img",6),l(),a(7,"ion-label"),d(8),l(),a(9,"ion-button",7),C("click",function(h){return b(c),x(h.stopPropagation())}),y(10,"ion-icon",8),l(),a(11,"ion-popover",9),z(12,Ai,17,13,"ng-template"),l()(),a(13,"ion-list",10),je(14),$(15,Ui,5,8,"ion-item",11),a(16,"ion-item")(17,"ion-label"),d(18),m(19,"localize"),l(),a(20,"ion-note"),d(21),l()(),a(22,"ion-item")(23,"ion-label"),d(24),m(25,"localize"),l(),a(26,"ion-note"),d(27),m(28,"date"),l()(),a(29,"ion-item",12)(30,"ion-label"),d(31),m(32,"localize"),l(),a(33,"ion-note"),d(34),m(35,"date"),l()(),$(36,Ni,6,4,"ion-item",13),l()()(),a(37,"ion-modal",14,0),z(39,Hi,3,2,"ng-template"),l()}if(t&2){let c=Le(n.info());s();let p=Le(n.users());s(5),u("src",c==null||c.creator==null?null:c.creator.photoUrl,Se),s(2),g(" ",(c==null?null:c.name)??"Event name"," "),s(3),u("dismissOnSelect",!0)("arrow",!1),s(3);let h=Le((p==null?null:p.length)??0);s(),F(h>0?15:-1),s(3),g(" ",_(19,18,n.EventMainInfoLocalize.Initiator)," "),s(3),g(" ",c==null||c.creator==null?null:c.creator.fullName," "),s(3),g(" ",_(25,20,n.EventMainInfoLocalize.Starts)," "),s(3),g(" ",O(28,22,c==null?null:c.starts,"dd.MM.yyyy")," "),s(2),u("lines",c!=null&&c.description?"":"none"),s(2),g(" ",_(32,25,n.EventMainInfoLocalize.Ends)," "),s(3),g(" ",O(35,27,c==null?null:c.ends,"dd.MM.yyyy")," "),s(2),F(c!=null&&c.description?36:-1),s(),u("initialBreakpoint",1)("breakpoints",re(30,$i))}},dependencies:[U,Re,R,Fe,Y,ue,X,fe,me,A,ve,mt,pt,$e,de,ze,ci,gt,Ae],styles:["ion-accordion-group[_ngcontent-%COMP%]{border-radius:.5rem}ion-list.info-list[_ngcontent-%COMP%]{margin-top:.5rem;background:transparent}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item.header-item[_ngcontent-%COMP%]{border-radius:.5rem;--padding-start: .75rem;--min-height: 3.7rem}ion-item.header-item[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:2.75rem!important;height:2.75rem!important}ion-item.header-item[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{margin-right:-1rem}ion-item.header-item[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}ion-item.header-item[_ngcontent-%COMP%]     .ion-accordion-toggle-icon{position:absolute;right:3rem}ion-item.notes-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-bottom:auto}ion-item.notes-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{padding:.5rem 0;margin-left:max(20%,2.5rem);text-align:end}ion-popover[_ngcontent-%COMP%]{--offset-y: -.25rem;--offset-x: -.6rem;--width: auto}ion-popover[_ngcontent-%COMP%]   .popover-menu-list[_ngcontent-%COMP%]{padding:.25rem 0;background-color:var(--ion-background-color-step-100);white-space:nowrap}app-avatars-list[_ngcontent-%COMP%]{opacity:.9}ion-modal[_ngcontent-%COMP%]{--height: auto}ion-modal[_ngcontent-%COMP%]   app-users-list[_ngcontent-%COMP%]{height:60vh;padding:1rem}"],changeDetection:0});let o=i;return o})();var di={FilterResults:{en:"Filter results",ru:"\u0424\u0438\u043B\u044C\u0442\u0440\u043E\u0432\u0430\u0442\u044C \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B"},Exclude:{en:"Exclude",ru:"\u0418\u0441\u043A\u043B\u044E\u0447\u0438\u0442\u044C "},Maybe:{en:'"maybe"',ru:'"\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E"'},Time:{en:'"time"',ru:'"\u0432\u0440\u0435\u043C\u044F"'},IgnorePastDates:{en:"Ignore past dates",ru:"\u0423\u0431\u0440\u0430\u0442\u044C \u043F\u0440\u043E\u0448\u0435\u0434\u0448\u0438\u0435 \u0434\u0430\u0442\u044B"},OnlyWithMe:{en:"Only with me",ru:"\u0422\u043E\u043B\u044C\u043A\u043E \u0441\u043E \u043C\u043D\u043E\u0439"},AtLeast:{en:"At least",ru:"\u041A\u0430\u043A \u043C\u0438\u043D\u0438\u043C\u0443\u043C"},Member:{en:"member",ru:"\u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A"}};var ui=yt(St());var fi=(()=>{let i=class i{set maxOverlap(e){(0,ui.isNil)(e)||this.membersCount.set(e)}constructor(){this.disabled=!1,this.noMaybe=P(!1),this.noTime=P(!1),this.onlyWithMe=P(!1),this.trimPast=P(!0),this.membersCount=P(1),this.ResultFiltersLocalize=di}ngOnInit(){}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-result-filters"]],inputs:{disabled:"disabled",maxMembers:"maxMembers",maxOverlap:"maxOverlap"},decls:38,vars:40,consts:[["mode","ios"],["value","filters","toggleIcon","remove-outline"],["slot","header",1,"header-item"],["slot","content","mode","ios"],[3,"ngModelChange","ngModel"],["color","warning"],["color","success"],["lines","none"],["lines","none",1,"range-list-item"],[3,"ngModelChange","ngModel","snaps","min","max","ticks"]],template:function(t,n){t&1&&(a(0,"ion-accordion-group",0)(1,"ion-accordion",1)(2,"ion-item",2)(3,"ion-label"),d(4),m(5,"localize"),l()(),a(6,"ion-list",3)(7,"ion-item")(8,"ion-checkbox",4),oe("ngModelChange",function(p){return ne(n.noMaybe,p)||(n.noMaybe=p),p}),d(9),m(10,"localize"),a(11,"ion-text",5),d(12),m(13,"localize"),l()()(),a(14,"ion-item")(15,"ion-checkbox",4),oe("ngModelChange",function(p){return ne(n.noTime,p)||(n.noTime=p),p}),d(16),m(17,"localize"),a(18,"ion-text",6),d(19),m(20,"localize"),l()()(),a(21,"ion-item")(22,"ion-checkbox",4),oe("ngModelChange",function(p){return ne(n.onlyWithMe,p)||(n.onlyWithMe=p),p}),d(23),m(24,"localize"),l()(),a(25,"ion-item")(26,"ion-checkbox",4),oe("ngModelChange",function(p){return ne(n.trimPast,p)||(n.trimPast=p),p}),d(27),m(28,"localize"),l()(),a(29,"ion-item",7)(30,"ion-label"),d(31),m(32,"localize"),l(),a(33,"ion-note"),d(34),m(35,"localizeMany"),l()(),a(36,"ion-item",8)(37,"ion-range",9),oe("ngModelChange",function(p){return ne(n.membersCount,p)||(n.membersCount=p),p}),l()()()()()),t&2&&(rt("disabled",n.disabled),s(4),g(" ",_(5,21,n.ResultFiltersLocalize.FilterResults)," "),s(4),ie("ngModel",n.noMaybe),s(),g(" ",_(10,23,n.ResultFiltersLocalize.Exclude)," "),s(3),g(" ",_(13,25,n.ResultFiltersLocalize.Maybe)," "),s(3),ie("ngModel",n.noTime),s(),g(" ",_(17,27,n.ResultFiltersLocalize.Exclude)," "),s(3),g(" ",_(20,29,n.ResultFiltersLocalize.Time)," "),s(3),ie("ngModel",n.onlyWithMe),s(),g(" ",_(24,31,n.ResultFiltersLocalize.OnlyWithMe)," "),s(3),ie("ngModel",n.trimPast),s(),g(" ",_(28,33,n.ResultFiltersLocalize.IgnorePastDates)," "),s(4),g(" ",_(32,35,n.ResultFiltersLocalize.AtLeast)," "),s(3),j(" ",n.membersCount()," ",O(35,37,n.ResultFiltersLocalize.Member,n.membersCount())," "),s(3),ie("ngModel",n.membersCount),u("snaps",!0)("min",1)("max",n.maxMembers)("ticks",n.maxMembers<=10))},dependencies:[U,R,ue,X,fe,ut,A,ve,mt,pt,Kt,Zt,ct,st,lt],styles:[".disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}ion-accordion[_ngcontent-%COMP%]{background:var(--ion-color-light, #f4f5f8);border-radius:.5rem;--padding-end: 0}.header-item[_ngcontent-%COMP%]{--inner-padding-end: .9rem}ion-list[_ngcontent-%COMP%]{background:var(--ion-color-light, #f4f5f8)}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{opacity:.85}ion-item[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{--knob-size: 22px}ion-item.range-list-item[_ngcontent-%COMP%]{margin-top:-.65rem;--padding-start: 1px;--inner-padding-end: .2rem}"]});let o=i;return o})();var hi=(o,i=500)=>{let r=J(o,"touchstart"),e=J(o,"touchend"),t=J(o,"touchmove");return r.pipe(w(n=>Lt(i).pipe(T(()=>n),te(G(e,t)))))};var Ce=class{static get dayFormat(){return"yyyy-MM-dd"}static get timeFormat(){return"yyyy-MM-dd'T'HH:mm:ss"}static toJsDates(i){return H(B({},i),{date:new Date(i.date),start:i.start?new Date(String(i.start).split(".")[0]):void 0,end:i.end?new Date(String(i.end).split(".")[0]):void 0})}static toStringDates(i){return H(B({},i),{date:N(i.date,this.dayFormat),start:i.start?N(i.start,this.timeFormat):void 0,end:i.end?N(i.end,this.timeFormat):void 0})}};var k=function(o){return o.Ready="ready",o.Maybe="maybe",o.Time="time",o}(k||{});var gi=yt(St());var Qi="rgba(var(--ion-color-base-rgb), 0.2)",Ze=o=>N(o,"yyyy-MM-dd"),_i=(()=>{let i=class i{set voteDates(e){let t=(0,gi.groupBy)(e,"voteType"),n=t[k.Ready]??[],c=t[k.Maybe]??[],p=t[k.Time]??[];this.readyDates.set(new Set(n.map(h=>Ze(h.date)))),this.maybeDates.set(new Set(c.map(h=>Ze(h.date)))),this.timeDates.set(new Map(p.map(h=>[Ze(h.date),h])))}get voteDates(){let e=this.readyDates(),t=this.maybeDates(),n=this.timeDates();return[...Array.from(e).map(c=>({date:new Date(c),voteType:k.Ready})),...Array.from(t).map(c=>({date:new Date(c),voteType:k.Maybe})),...Array.from(n.values())]}get rootEl(){return this.elRef.nativeElement.shadowRoot}constructor(){this.readyDates=P(new Set),this.maybeDates=P(new Set),this.timeDates=P(new Map),this.lastFocusedDateButton$=new we(1),this.focusedTimeChanges=this.lastFocusedDateButton$.pipe(T(e=>{if(!e)return;let t=Number(e.getAttribute("data-day")),n=Number(e.getAttribute("data-month")),c=Number(e.getAttribute("data-year")),p=new Date(c,n-1,t);return this.timeDates().get(Ze(p))})),this.ionDateComponent=v(he),this.elRef=v(le),this.rootObs=new MutationObserver(()=>{let e=this.rootEl.querySelectorAll("button.calendar-day");this.dateButtons$.next(Array.from(e))}),this.dateButtons$=new we(1),this.destroyed$=new we(1),Qe(()=>{let e=this.readyDates();this.ionDateComponent.value=Array.from(e)}),Qe(()=>{let e=this.maybeDates(),t=this.timeDates();this.ionDateComponent.highlightedDates=[...Array.from(e).map(n=>({date:n,textColor:"var(--maybe-text-color)",backgroundColor:"var(--maybe-bg-color)"})),...Array.from(t.keys()).map(n=>({date:n,textColor:"var(--time-text-color)",backgroundColor:"var(--time-bg-color)"}))]})}ngAfterViewInit(){this.rootObs.observe(this.rootEl,{childList:!0,subtree:!0}),this.dateButtons$.pipe(w(e=>{let t=e.map(n=>{let c=J(n,"contextmenu"),p=hi(n);return G(c,p).pipe(V(h=>h.preventDefault()),T(h=>H(B({},h),{target:n})),Rt(500))});return G(...t)}),te(this.destroyed$)).subscribe(e=>this.showPopover(e)),this.ionDateComponent.ionChange.pipe(te(this.destroyed$)).subscribe(e=>{let t=e.detail.value,n=this.readyDates(),c=this.maybeDates(),p=this.timeDates();n.clear(),t?.forEach(h=>{c.has(h)?c.delete(h):p.has(h)?p.delete(h):n.add(h)}),this.emitAllDatesSignals()})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete(),this.dateButtons$.complete(),this.rootObs.disconnect()}showPopover(e){let t=e.target;this.popover.present(e);let n=t.style.backgroundColor??"";this.popover.willPresent.pipe(We(1)).subscribe(()=>{this.lastFocusedDateButton$.next(t),t.style.backgroundColor=Qi}),this.popover.willDismiss.pipe(We(1)).subscribe(c=>{if(this.lastFocusedDateButton$.next(void 0),t.style.backgroundColor=n,c.detail.data){let p=Number(t.getAttribute("data-day")),h=Number(t.getAttribute("data-month")),E=Number(t.getAttribute("data-year"));this.handlePopoverButtons(c.detail.data,E,h,p)}})}handlePopoverButtons(e,t,n,c){let p=new Date(t,n-1,c),h=Ze(p);if(e.ready)this.readyDates().add(h),this.maybeDates().delete(h),this.timeDates().delete(h);else if(e.maybe)this.maybeDates().add(h),this.readyDates().delete(h),this.timeDates().delete(h);else if(e.time){let E=new Date(e.start),K=new Date(e.end);E.setFullYear(t,n-1,c),K.setFullYear(t,n-1,c);let tt={date:p,voteType:k.Time,start:E,end:K};this.timeDates().set(h,tt),this.readyDates().delete(h),this.maybeDates().delete(h)}this.emitAllDatesSignals()}emitAllDatesSignals(){this.readyDates.set(new Set(this.readyDates())),this.maybeDates.set(new Set(this.maybeDates())),this.timeDates.set(new Map(this.timeDates()))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=q({type:i,selectors:[["","appIonDateSpecify",""]],inputs:{popover:"popover",voteDates:"voteDates"},outputs:{focusedTimeChanges:"focusedTimeChanges"},exportAs:["appIonDateSpecify"]});let o=i;return o})();var vi=(()=>{let i=class i{constructor(){this.popover=v(ze),this.destroyed$=new W}ngOnInit(){this.popover.willPresent.pipe(nt(e=>!!e.target),w(e=>J(e.target,"contextmenu")),te(this.destroyed$)).subscribe(e=>e.preventDefault())}ngOnDestroy(){this.destroyed$.next(void 0),this.destroyed$.complete()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=q({type:i,selectors:[["","appPreventPopoverContext",""]]});let o=i;return o})();var Tt={Ready:{en:"Ready",ru:"\u0413\u043E\u0442\u043E\u0432"},Maybe:{en:"Maybe",ru:"\u0412\u043E\u0437\u043C\u043E\u0436\u043D\u043E"},Time:{en:"Time",ru:"\u0412\u0440\u0435\u043C\u044F"},HoldDate:{en:"Hold date",ru:"\u0423\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u0430\u0442\u0443,"},RightClickDate:{en:"Right click on date",ru:"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u043F\u0440\u0430\u0432\u043E\u0439 \u043A\u043D\u043E\u043F\u043A\u043E\u0439 \u043C\u044B\u0448\u0438 \u043F\u043E \u0434\u0430\u0442\u0435,"},SelectSpecificStatus:{en:"to select specific status",ru:"\u0447\u0442\u043E\u0431\u044B \u0432\u044B\u0431\u0440\u0430\u0442\u044C \u0441\u0442\u0430\u0442\u0443\u0441"},DoNotForgetSave:{en:"Don't forget to save changes",ru:"\u041D\u0435 \u0437\u0430\u0431\u0443\u0434\u044C\u0442\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F"},Clear:{en:"Clear",ru:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C"},Cancel:{en:"Cancel",ru:"\u041E\u0442\u043C\u0435\u043D\u0430"},Save:{en:"Save",ru:"\u0413\u043E\u0442\u043E\u0432\u043E"},StartTime:{en:"Start time",ru:"\u0412\u0440\u0435\u043C\u044F \u043D\u0430\u0447\u0430\u043B\u0430"},EndTime:{en:"End time",ru:"\u0412\u0440\u0435\u043C\u044F \u043E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u044F"},SpecifyTime:{en:"Specify time",ru:"\u0423\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0440\u0435\u043C\u044F"},HasBeenSaved:{en:"All changes have been saved successfully",ru:"\u0412\u0441\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B"}};var yi=(()=>{let i=class i{constructor(){this.baseUrl="votes",this.http=v(Be)}getEventVote(e){let t={eventId:e};return this.http.get(this.baseUrl,{params:t}).pipe(T(n=>{let c=n.dates.map(p=>Ce.toJsDates(p));return H(B({},n),{dates:c})}))}updateEventVote(e,t){let c={dates:t.map(h=>Ce.toStringDates(h))},p={eventId:e};return this.http.post(this.baseUrl,c,{params:p}).pipe(T(h=>{let E=h.dates.map(K=>Ce.toJsDates(K));return H(B({},h),{dates:E})}))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ie({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var Yi=()=>[],Gi=()=>[0,1];function Ji(o,i){if(o&1){let r=S();a(0,"div",24)(1,"ion-button",25,3),C("click",function(){b(r),f();let t=M(41);return x(t.dismiss({ready:!0}))}),y(3,"ion-icon",26),l(),a(4,"ion-button",27,4),C("click",function(){b(r),f();let t=M(41);return x(t.dismiss({maybe:!0}))}),y(6,"ion-icon",28),l(),a(7,"ion-button",29,5),C("click",function(){b(r),f();let t=M(44);return x(t.present())}),y(9,"ion-icon",30),l()()}}function Xi(o,i){if(o&1){let r=S();a(0,"div",31)(1,"div",32)(2,"div",33)(3,"ion-label"),d(4),m(5,"localize"),l(),a(6,"ion-datetime",34),oe("ngModelChange",function(t){b(r);let n=f();return ne(n.startTime,t)||(n.startTime=t),x(t)}),l()(),a(7,"div",33)(8,"ion-label"),d(9),m(10,"localize"),l(),a(11,"ion-datetime",34),oe("ngModelChange",function(t){b(r);let n=f();return ne(n.endTime,t)||(n.endTime=t),x(t)}),l()()(),a(12,"ion-button",35),C("click",function(){b(r);let t=f(),n=M(41);return M(44).dismiss(),x(n.dismiss({time:!0,start:t.startTime(),end:t.endTime()}))}),d(13),m(14,"localize"),l()()}if(o&2){let r=f();s(4),g(" ",_(5,6,r.VoteCalendarLocalize.StartTime)," "),s(2),ie("ngModel",r.startTime),s(3),g(" ",_(10,8,r.VoteCalendarLocalize.EndTime)," "),s(2),ie("ngModel",r.endTime),s(),u("disabled",r.isTimeInvalid()),s(),g(" ",_(14,10,r.VoteCalendarLocalize.SpecifyTime)," ")}}var et="yyyy-MM-dd'T'HH:mm:ss",Ci=(()=>{let i=class i{constructor(){this.eventId=D.required(),this.minDate=D(),this.maxDate=D(),this.voteUpdated=Ye(),this.resetDates$=new W,this.clearDates$=new W,this.saveDates$=new W,this.request=v(yi),this.featureLoad=v(ye,{optional:!0}),this.loadedEventVote$=ge(this.eventId).pipe(V(()=>this.featureLoad?.incrLoading()),w(e=>this.request.getEventVote(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),se(1)),this.updatedEventVote$=this.saveDates$.pipe(V(()=>this.featureLoad?.incrLoading()),w(e=>this.request.updateEventVote(this.eventId(),e).pipe(Z(()=>this.featureLoad?.decrLoading()))),V(e=>this.voteUpdated.emit(e)),V(()=>{let e=this.loc.localizeSync(Tt.HasBeenSaved);this.toast.info(e,"cloud-done-outline")}),se(1)),this.voteDates$=G(this.clearDates$.pipe(T(()=>[])),this.resetDates$.pipe(ee(!0),w(()=>G(this.loadedEventVote$,this.updatedEventVote$)),T(e=>e.dates.slice()))),this.startTime=P(N(new Date,et)),this.endTime=P(N(new Date,et)),this.isTimeInvalid=Q(()=>{let e=new Date(this.startTime()),t=new Date(this.endTime());return e>=t}),this.toast=v(ht),this.tools=v(ii),this.isTouchDevice=this.tools.isTouchDevice,this.loc=v(_e),this.localizeFormat$=this.loc.localizationWithFormat$,this.VoteCalendarLocalize=Tt}updateTime(e){let t=N(new Date,et),n=e?.start?N(e.start,et):t,c=e?.end?N(e.end,et):t;this.startTime.set(n),this.endTime.set(c)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-vote-calendar"]],inputs:{eventId:[1,"eventId"],minDate:[1,"minDate"],maxDate:[1,"maxDate"]},outputs:{voteUpdated:"voteUpdated"},decls:46,vars:43,consts:[["appIonDateSpecify","appIonDateSpecify"],["popover",""],["timeModal",""],["readyButton",""],["maybeButton",""],["timeButton",""],[1,"vote-calendar"],[1,"vote-calendar-header"],[1,"chips"],["color","primary",1,"ion-activated"],["name","checkmark-outline"],["color","warning",1,"ion-activated"],["name","help-outline"],["color","success",1,"ion-activated"],["name","time-outline"],[1,"subtitle"],["appIonDateSpecify","","presentation","date","mode","ios",3,"focusedTimeChanges","voteDates","popover","multiple","firstDayOfWeek","min","max","locale"],["mode","ios",1,"vote-calendar-actions"],["color","medium",3,"click"],[1,"right"],["color","danger",3,"click"],["color","primary",3,"click"],["appPreventPopoverContext","","mode","ios","side","top","alignment","center",3,"arrow"],[3,"initialBreakpoint","breakpoints"],[1,"popover-content"],["size","small","color","primary",3,"click"],["name","checkmark-outline","slot","icon-only"],["size","small","color","warning",3,"click"],["name","help-outline","slot","icon-only"],["size","small","color","success",3,"click"],["name","time-outline","slot","icon-only"],[1,"time-modal-content"],[1,"time-pickers"],[1,"pick"],["presentation","time","mode","ios",3,"ngModelChange","ngModel"],["mode","ios",3,"click","disabled"]],template:function(t,n){if(t&1){let c=S();a(0,"div",6)(1,"div",7)(2,"div",8)(3,"ion-chip",9),y(4,"ion-icon",10),a(5,"ion-label"),d(6),m(7,"localize"),l()(),a(8,"ion-chip",11),y(9,"ion-icon",12),a(10,"ion-label"),d(11),m(12,"localize"),l()(),a(13,"ion-chip",13),y(14,"ion-icon",14),a(15,"ion-label"),d(16),m(17,"localize"),l()()(),a(18,"span",15),d(19),m(20,"localize"),m(21,"localize"),y(22,"br"),d(23),m(24,"localize"),l()(),a(25,"ion-datetime",16,0),m(27,"async"),m(28,"async"),C("focusedTimeChanges",function(h){return b(c),x(n.updateTime(h))}),l(),a(29,"ion-buttons",17)(30,"ion-button",18),C("click",function(){return b(c),x(n.clearDates$.next(!0))}),d(31),m(32,"localize"),l(),a(33,"div",19)(34,"ion-button",20),C("click",function(){return b(c),x(n.resetDates$.next(!0))}),d(35),m(36,"localize"),l(),a(37,"ion-button",21),C("click",function(){b(c);let h=M(26);return x(n.saveDates$.next(h.voteDates))}),d(38),m(39,"localize"),l()()()(),a(40,"ion-popover",22,1),z(42,Ji,10,0,"ng-template"),l(),a(43,"ion-modal",23,2),z(45,Xi,15,12,"ng-template"),l()}if(t&2){let c=M(41);s(6),g(" ",_(7,19,n.VoteCalendarLocalize.Ready)," "),s(5),g(" ",_(12,21,n.VoteCalendarLocalize.Maybe)," "),s(5),g(" ",_(17,23,n.VoteCalendarLocalize.Time)," "),s(3),j(" ",_(20,25,n.isTouchDevice?n.VoteCalendarLocalize.HoldDate:n.VoteCalendarLocalize.RightClickDate)," ",_(21,27,n.VoteCalendarLocalize.SelectSpecificStatus)," "),s(4),g(" ",_(24,29,n.VoteCalendarLocalize.DoNotForgetSave)," "),s(2),u("voteDates",_(27,31,n.voteDates$)??re(41,Yi))("popover",c)("multiple",!0)("firstDayOfWeek",1)("min",n.minDate()??void 0)("max",n.maxDate()??void 0)("locale",_(28,33,n.localizeFormat$)),s(6),g(" ",_(32,35,n.VoteCalendarLocalize.Clear)," "),s(4),g(" ",_(36,37,n.VoteCalendarLocalize.Cancel)," "),s(3),g(" ",_(39,39,n.VoteCalendarLocalize.Save)," "),s(2),u("arrow",!0),s(3),u("initialBreakpoint",1)("breakpoints",re(42,Gi))}},dependencies:[U,R,Fe,Qt,Y,pe,A,_i,vi,he,dt,ze,de,ct,st,lt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%}.vote-calendar-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;background-color:var(--ion-color-light, #f4f5f8);padding:.5rem .5rem .25rem;border-top-left-radius:.5rem;border-top-right-radius:.5rem}.vote-calendar-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{padding:0 .5rem;color:var(--ion-text-color-step-600, #b3b3b3);font-size:.9rem;line-height:1.25rem;margin-top:.125rem;margin-bottom:1rem}.vote-calendar-header[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{display:flex;padding:0 .2rem;justify-content:space-between;gap:.25rem}.vote-calendar-header[_ngcontent-%COMP%]   .ion-activated[_ngcontent-%COMP%]{pointer-events:none}.vote-calendar-actions[_ngcontent-%COMP%]{padding:.5rem .75rem;background-color:var(--ion-color-light, #f4f5f8);justify-content:space-between;border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem;gap:1rem}.vote-calendar-actions[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;gap:.5rem}ion-datetime[_ngcontent-%COMP%]{border-radius:0}ion-popover[_ngcontent-%COMP%]{--offset-y: -.15rem;--width: 8rem}.popover-content[_ngcontent-%COMP%]{padding:.5rem;width:100%;display:flex;justify-content:space-between;gap:.25rem;opacity:.95}ion-modal[_ngcontent-%COMP%]{--height: auto}.time-modal-content[_ngcontent-%COMP%]{padding:1.5rem;display:flex;flex-direction:column;gap:1rem}.time-modal-content[_ngcontent-%COMP%]   .time-pickers[_ngcontent-%COMP%]{display:flex;gap:1rem}.time-modal-content[_ngcontent-%COMP%]   .time-pickers[_ngcontent-%COMP%]   .pick[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;gap:1rem}.time-modal-content[_ngcontent-%COMP%]   .time-pickers[_ngcontent-%COMP%]   .pick[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{width:100%;border-radius:1rem}"],changeDetection:0});let o=i;return o})();var ae=function(o){return o.List="list",o.Calendar="calendar",o}(ae||{});var bi=(()=>{let i=class i{constructor(){this.disabled=!1,this.ViewPick=ae,this.value=P(ae.List),this.refresh=new Bt}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-result-view-picker-control"]],inputs:{disabled:"disabled"},outputs:{refresh:"refresh"},decls:7,vars:3,consts:[[1,"picker",3,"ngClass"],[1,"item",3,"click"],["name","list-outline"],["name","calendar-outline"],[3,"click"],["slot","icon-only","name","refresh-outline"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1),C("click",function(){return n.value.set(n.ViewPick.List)}),y(2,"ion-icon",2),l(),a(3,"div",1),C("click",function(){return n.value.set(n.ViewPick.Calendar)}),y(4,"ion-icon",3),l()(),a(5,"ion-button",4),C("click",function(){return n.refresh.emit()}),y(6,"ion-icon",5),l()),t&2&&(rt("disabled",n.disabled),u("ngClass",n.value()))},dependencies:[U,jt,Fe,Y],styles:['[_nghost-%COMP%]{display:flex;justify-content:space-between;align-items:center}.picker[_ngcontent-%COMP%]{position:relative;display:flex;border-radius:.5rem;background-color:var(--ion-color-light, #f4f5f8);--border-size: 2px}.picker.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.picker[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{z-index:2;padding:.8rem 1.25rem;display:flex;align-items:center;cursor:pointer}.picker[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{opacity:.7}.picker[_ngcontent-%COMP%]:after{content:"";transition:left .2s ease-in-out;z-index:1;position:absolute;top:var(--border-size);bottom:var(--border-size);width:calc(50% - var(--border-size) * 2);box-shadow:var(--picker-box-shadow);background-color:var(--ion-background-color-step-350, #fff);border-radius:.5rem}.picker.list[_ngcontent-%COMP%]:after{left:var(--border-size)!important}.picker.calendar[_ngcontent-%COMP%]:after{left:calc(50% + var(--border-size))!important}ion-button[_ngcontent-%COMP%]{margin:0;--border-radius: .5rem;--padding-bottom: .75rem;--padding-end: .75rem;--padding-start: .75rem;--padding-top: .75rem}']});let o=i;return o})();var Ki=["*"],Zi=(o,i)=>({value:o,params:i}),xi="0.4s ease-in-out",en={transform:"translateX(0)"},tn={transform:"translateX({{ leaveEnd }}%)"},nn={transform:"translateX({{ enterStart }}%)"},Mi=(()=>{let i=class i{constructor(){this.viewPick=D.required(),this.animationDisabled=P(!0),this.animationParams=Q(()=>{switch(this.viewPick()){case ae.List:return{leaveEnd:120,enterStart:-120};case ae.Calendar:return{leaveEnd:-120,enterStart:120};default:return{}}}),zt(()=>{this.animationDisabled()&&this.animationDisabled.set(!1)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-result-view-picker-container"]],inputs:{viewPick:[1,"viewPick"]},ngContentSelectors:Ki,decls:2,vars:5,consts:[[1,"result-view-picker-container-animated"]],template:function(t,n){t&1&&(At(),a(0,"div",0),Ut(1),l()),t&2&&u("@.disabled",n.animationDisabled())("@openCloseResultView",He(2,Zi,n.viewPick(),n.animationParams()))},styles:[".result-view-picker-container-animated[_ngcontent-%COMP%]{display:grid;overflow:hidden;place-items:start}  .result-view-picker-container-animated>*{display:block;grid-column:1;grid-row:1;width:100%}"],data:{animation:[Dt("openCloseResultView",[It("* => *",[wt([Je(":enter",Ge(nn)),Je(":leave",[ft(xi,Ge(tn))],{optional:!0}),Je(":enter",[ft(xi),Ge(en)])])],{params:{leaveEnd:-120,enterStart:120}})])]},changeDetection:0});let o=i;return o})();var Di=(()=>{let i=class i{constructor(){this.baseUrl="results",this.http=v(Be)}getEventResults(e){let t={eventId:e};return this.http.get(this.baseUrl,{params:t}).pipe(T(n=>{let c=n.dates.map(p=>Ce.toJsDates(p));return H(B({},n),{dates:c})}))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ie({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var on=ai(new Date),be=(()=>{let i=class i{constructor(){this.eventId=D.required(),this.min=D.required(),this.noMaybe=D.required(),this.noTime=D.required(),this.onlyWithMe=D.required(),this.trimPast=D.required(),this.request=v(Di),this.featureLoad=v(ye,{optional:!0}),this.refresh$=new W,this.eventid$=ge(this.eventId),this.info$=this.refresh$.pipe(ee(!0),w(()=>this.eventid$),V(()=>this.featureLoad?.incrLoading()),w(e=>this.request.getEventResults(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),se(1)),this.info=Xe(this.info$),this.dates=Q(()=>this.info()?.dates??[]),this.filteredDates=Q(()=>this.dates().filter(e=>e.users.length>=this.min()&&(!this.trimPast()||e.date>=on)&&(!this.noMaybe()||e.voteType!==k.Maybe)&&(!this.noTime()||e.voteType!==k.Time)&&(!this.onlyWithMe()||e.isWithMe))),this.filteredDatesMap=Q(()=>{let e=this.filteredDates();return new Map(e.map(t=>[this.formatVoteDate(t.date),t]))})}refresh(){this.refresh$.next(!0)}formatVoteDate(e){return N(e,"yyyy-MM-dd")}getVoteDate(e){let t=this.formatVoteDate(e);return this.filteredDatesMap().get(t)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=q({type:i,selectors:[["","appResultView",""]],inputs:{eventId:[1,"eventId"],min:[1,"min"],noMaybe:[1,"noMaybe"],noTime:[1,"noTime"],onlyWithMe:[1,"onlyWithMe"],trimPast:[1,"trimPast"]},exportAs:["appResultView"]});let o=i;return o})();var Ii=yt(St());var xe=class{static getColorByType(i){switch(i){case k.Ready:return"primary";case k.Maybe:return"warning";case k.Time:return"success"}}static getIconByType(i){switch(i){case k.Ready:return"checkmark-outline";case k.Maybe:return"help-outline";case k.Time:return"time-outline"}}};var Ne={Member:{en:"member",ru:"\u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A"},NoData:{en:"No data, try to change filters",ru:"\u041F\u0443\u0441\u0442\u043E, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0444\u0438\u043B\u044C\u0442\u0440\u044B"},NoTimeOverlap:{en:"No time overlap",ru:"\u041D\u0435\u0442 \u043E\u0431\u0449\u0435\u0433\u043E \u0432\u0440\u0435\u043C\u0435\u043D\u0438"}};var rn=()=>[0,1];function an(o,i){if(o&1&&($t(0),a(1,"h3"),d(2),m(3,"date"),l(),Ft()),o&2){let r=i.ngIf,e=f(3);s(2),g(" ",Wt(3,1,e.resultDate.date,r.dateFormat,void 0,r.localize)," ")}}function sn(o,i){if(o&1&&(a(0,"ion-chip",6),y(1,"ion-icon",9),a(2,"ion-label"),d(3),m(4,"localize"),l()()),o&2){let r=f(3);s(3),g(" ",_(4,1,r.ResultViewLocalize.NoTimeOverlap)," ")}}function ln(o,i){if(o&1&&(a(0,"ion-chip",7),y(1,"ion-icon",10),a(2,"ion-label"),d(3),m(4,"date"),m(5,"date"),l()()),o&2){let r=f(3);u("color",r.Helpers.getColorByType(r.resultDate.voteType)),s(),u("name",r.Helpers.getIconByType(r.resultDate.voteType)),s(2),j(" ",r.resultDate.start?O(4,4,r.resultDate.start,"HH:mm"):"00:00"," - ",r.resultDate.end?O(5,7,r.resultDate.end,"HH:mm"):"23:59"," ")}}function cn(o,i){if(o&1&&(a(0,"ion-text",11),d(1),l()),o&2){let r=f().$implicit;s(),g(" ",r.username?"@"+r.username:r.fullName," ")}}function pn(o,i){if(o&1&&d(0),o&2){let r=f().$implicit;g(" ",r.fullName," ")}}function mn(o,i){if(o&1&&(a(0,"ion-label"),$(1,cn,2,1,"ion-text",11)(2,pn,1,1),l()),o&2){let r=i.$implicit,e=f(3);s(),F(e.timeModeIndexes.has(r.index)?1:2)}}function dn(o,i){if(o&1&&(a(0,"ion-text",12),d(1),m(2,"date"),m(3,"date"),l()),o&2){let r=f().$implicit,e=f(3);u("color",e.Helpers.getColorByType(r.voteType)),s(),j(" ",r.start?O(2,3,r.start,"HH:mm"):"00:00"," - ",r.end?O(3,6,r.end,"HH:mm"):"23:59"," ")}}function un(o,i){if(o&1&&y(0,"ion-icon",13),o&2){let r=f().$implicit,e=f(3);u("color",e.Helpers.getColorByType(r.voteType))("icon",e.Helpers.getIconByType(r.voteType))}}function fn(o,i){if(o&1&&$(0,dn,4,9,"ion-text",12)(1,un,1,2,"ion-icon",13),o&2){let r=i.$implicit,e=f(3);F(e.timeModeIndexes.has(r.index)?0:1)}}function hn(o,i){if(o&1){let r=S();a(0,"div",4),z(1,an,4,6,"ng-container",5),m(2,"async"),$(3,sn,5,3,"ion-chip",6)(4,ln,6,10,"ion-chip",7),l(),a(5,"app-users-list",8),C("userClicked",function(t){b(r);let n=f(2);return x(n.toggleUserMode(t.user))})("searchFocused",function(t){b(r),f(2);let n=M(1);return x(n.backdropDismiss=!t)}),z(6,mn,3,1,"ng-template",null,1,qe)(8,fn,2,1,"ng-template",null,2,qe),l()}if(o&2){let r=f(2);s(),u("ngIf",_(2,4,r.dateFormat$)),s(2),F(r.resultDate.noTimeOverlap?3:4),s(2),u("users",r.resultDate.users)("clickable",!0)}}function gn(o,i){if(o&1&&$(0,hn,10,6),o&2){let r=f();F(r.resultDate?0:-1)}}var vt=(()=>{let i=class i{constructor(){this.ionModal=Oe(de),this.timeModeIndexes=new Set,this.Helpers=xe,this.localizeService=v(_e),this.ResultViewLocalize=Ne,this.dateFormat$=this.localizeService.localizeLongDateFormat$}present(e){let t=this.ionModal();t&&(this.resultDate=e,e.users=e.users.map((n,c)=>H(B({},n),{index:c})),t.present())}clearData(){this.resultDate=void 0,this.timeModeIndexes=new Set}toggleUserMode(e){let t=e.index;this.timeModeIndexes.has(t)?this.timeModeIndexes.delete(t):this.timeModeIndexes.add(t)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-result-date-info-modal"]],viewQuery:function(t,n){t&1&&Ee(n.ionModal,de,5),t&2&&Ve()},decls:3,vars:3,consts:[["modal",""],["altLabel",""],["end",""],[3,"ionModalDidDismiss","initialBreakpoint","breakpoints"],[1,"header"],[4,"ngIf"],["color","danger"],[1,"ion-activated",3,"color"],[3,"userClicked","searchFocused","users","clickable"],["name","alert-circle-outline"],[3,"name"],["color","medium"],[1,"user-time-info",3,"color"],[3,"color","icon"]],template:function(t,n){if(t&1){let c=S();a(0,"ion-modal",3,0),C("ionModalDidDismiss",function(){return b(c),x(n.clearData())}),z(2,gn,1,1,"ng-template"),l()}t&2&&u("initialBreakpoint",1)("breakpoints",re(2,rn))},dependencies:[U,Re,R,Y,ut,pe,me,A,gt,de,dt],styles:["ion-modal[_ngcontent-%COMP%]{--height: auto}ion-modal[_ngcontent-%COMP%]   app-users-list[_ngcontent-%COMP%]{height:52vh;padding:0 1rem 1rem}.header[_ngcontent-%COMP%]{padding:2rem 2rem .5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;column-gap:.5rem;row-gap:.25rem}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.header[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{pointer-events:none;margin:0}.user-time-info[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:-1px}"]});let o=i;return o})();var wi=(()=>{let i=class i{get rootEl(){return this.elRef.nativeElement.shadowRoot}constructor(){this.data=v(be),this.elRef=v(le),this.rootObs=new MutationObserver(()=>{let e=this.rootEl.querySelectorAll("button.calendar-day");this.dateButtons$.next(Array.from(e))}),this.dateButtons$=new we(1),this.voteDateSelected$=this.dateButtons$.pipe(w(e=>{let t=e.map(n=>J(n,"click",{capture:!0}).pipe(V(c=>c.stopPropagation()),T(()=>n)));return G(...t)}),ot((e,t)=>!this.noActionsAfterReset&&e===t),T(e=>this.getDateSelectedEvent(e)),T(e=>e.voteDate?e:void 0),ee(void 0),Ot(),V(([e,t])=>this.handleButtonStyles(e,t)),T(([e,t])=>t?.voteDate),V(()=>this.noActionsAfterReset=!1)),this.noActionsAfterReset=!0,this.dateSelected=G(this.voteDateSelected$,this.getResetDateEvent(this.dateButtons$),this.getResetDateEvent(ge(this.data.filteredDates)))}ngAfterViewInit(){this.rootObs.observe(this.rootEl,{childList:!0,subtree:!0})}ngOnDestroy(){this.dateButtons$.complete(),this.rootObs.disconnect()}getResetDateEvent(e){return e.pipe(V(()=>this.noActionsAfterReset=!0),T(()=>{}))}getDateSelectedEvent(e){let t=Number(e.getAttribute("data-day")),n=Number(e.getAttribute("data-month")),c=Number(e.getAttribute("data-year")),p=new Date(c,n-1,t);return{prevBgColor:e.style.backgroundColor,prevColor:e.style.color,voteDate:this.data.getVoteDate(p),buttonEl:e}}handleButtonStyles(e,t){if(e&&!this.noActionsAfterReset){let n=e.buttonEl;n.style.backgroundColor=e.prevBgColor,n.style.color=e.prevColor}if(t){let n=t.buttonEl;n.style.backgroundColor=n.style.color,n.style.color="var(--ion-color-contrast)"}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=q({type:i,selectors:[["","appResultViewCalendarPicker",""]],outputs:{dateSelected:"dateSelected"}});let o=i;return o})();function _n(o,i){if(o&1){let r=S();a(0,"div",4)(1,"ion-item",5),C("click",function(){let t=b(r).ngIf;f();let n=M(6);return x(n.present(t))}),y(2,"ion-icon",6),a(3,"ion-label"),d(4),m(5,"date"),l(),a(6,"ion-note",7),d(7),m(8,"localizeMany"),l()()()}if(o&2){let r=i.ngIf,e=f();s(2),u("color",r.noTimeOverlap?"danger":e.Helpers.getColorByType(r.voteType))("name",e.Helpers.getIconByType(r.voteType)),s(2),g(" ",O(5,5,r.date,"dd.MM.yyyy")," "),s(3),j(" ",r.users.length," ",O(8,8,e.ResultViewLocalize.Member,r.users.length)," ")}}var Si=(()=>{let i=class i{constructor(){this.minDate=D(),this.maxDate=D(),this.ionDateComponent=Oe(he),this.data=v(be),this.Helpers=xe,this.ResultViewLocalize=Ne,this.selectedDate=P(void 0),this.localizeService=v(_e),this.localizeFormat$=this.localizeService.localizationWithFormat$,Qe(()=>{let e=this.ionDateComponent(),t=this.data.filteredDates();if(e)if(t.length===0){e.highlightedDates=[];return}else{let n=(0,Ii.groupBy)(t,"voteType"),c=n[k.Ready]??[],p=n[k.Maybe]??[],h=n[k.Time]??[];e.highlightedDates=[...c.map(E=>({date:this.data.formatVoteDate(E.date),textColor:"var(--ready-text-color)",backgroundColor:"var(--ready-bg-color)"})),...p.map(E=>({date:this.data.formatVoteDate(E.date),textColor:"var(--maybe-text-color)",backgroundColor:"var(--maybe-bg-color)"})),...h.map(E=>({date:this.data.formatVoteDate(E.date),textColor:"var(--time-text-color)",backgroundColor:"var(--time-bg-color)"}))]}else return})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-result-view-calendar"]],viewQuery:function(t,n){t&1&&Ee(n.ionDateComponent,he,5),t&2&&Ve()},inputs:{minDate:[1,"minDate"],maxDate:[1,"maxDate"]},decls:7,vars:7,consts:[["infoModal",""],[1,"calendar-header"],["appResultViewCalendarPicker","","presentation","date","mode","ios",3,"dateSelected","firstDayOfWeek","min","max","locale"],["class","calendar-footer",4,"ngIf"],[1,"calendar-footer"],["button","","lines","none",3,"click"],["slot","start",3,"color","name"],["slot","end"]],template:function(t,n){if(t&1){let c=S();a(0,"div"),y(1,"div",1),a(2,"ion-datetime",2),m(3,"async"),C("dateSelected",function(h){return b(c),x(n.selectedDate.set(h))}),l(),z(4,_n,9,11,"div",3),l(),y(5,"app-result-date-info-modal",null,0)}t&2&&(s(2),u("firstDayOfWeek",1)("min",n.minDate()??void 0)("max",n.maxDate()??void 0)("locale",_(3,5,n.localizeFormat$)),s(2),u("ngIf",n.selectedDate()))},dependencies:[U,Re,R,Y,X,fe,pe,me,ve,he,vt,wi],styles:[".calendar-header[_ngcontent-%COMP%]{background-color:var(--ion-color-light, #f4f5f8);border-top-left-radius:.5rem;border-top-right-radius:.5rem;width:100%;height:.5rem}ion-datetime[_ngcontent-%COMP%]:last-child{border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem}.calendar-footer[_ngcontent-%COMP%]{background-color:var(--ion-color-light, #f4f5f8);border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem;padding-bottom:.25rem}.calendar-footer[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}"],changeDetection:0});let o=i;return o})();function vn(o,i){if(o&1){let r=S();a(0,"ion-item",4),C("click",function(){let t=b(r).$implicit;f();let n=M(5);return x(n.present(t))}),y(1,"ion-icon",5),a(2,"ion-label"),d(3),m(4,"date"),l(),a(5,"ion-note",6),d(6),m(7,"localizeMany"),l()()}if(o&2){let r=i.$implicit,e=i.$index,t=i.$count,n=f();u("lines",e===t-1?"none":""),s(),u("color",r.noTimeOverlap?"danger":n.Helpers.getColorByType(r.voteType))("name",n.Helpers.getIconByType(r.voteType)),s(2),g(" ",O(4,6,r.date,"dd.MM.yyyy")," "),s(3),j(" ",r.users.length," ",O(7,9,n.ResultViewLocalize.Member,r.users.length)," ")}}function yn(o,i){if(o&1&&(a(0,"ion-item",3),y(1,"ion-icon",7),a(2,"ion-note",8),d(3),m(4,"localize"),l()()),o&2){let r=f();s(3),g(" ",_(4,1,r.ResultViewLocalize.NoData)," ")}}var ki=(()=>{let i=class i{constructor(){this.data=v(be),this.filteredDates=this.data.filteredDates,this.Helpers=xe,this.ResultViewLocalize=Ne}ngOnInit(){}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-result-view-list"]],decls:6,vars:1,consts:[["infoModal",""],["mode","ios"],["button","",3,"lines"],["lines","none"],["button","",3,"click","lines"],["slot","start",3,"color","name"],["slot","end"],["slot","start","name","calendar-clear-outline","color","medium"],[1,"no-data"]],template:function(t,n){t&1&&(a(0,"ion-list",1),Te(1,vn,8,12,"ion-item",2,ke,!1,yn,5,3,"ion-item",3),l(),y(4,"app-result-date-info-modal",null,0)),t&2&&(s(),Pe(n.filteredDates()))},dependencies:[U,R,Y,ue,X,fe,me,A,ve,vt],styles:["ion-list[_ngcontent-%COMP%]{background:var(--ion-color-light, #f4f5f8);border-radius:.5rem;padding-block:.25rem}ion-item[_ngcontent-%COMP%]{--background: transparent}.no-data[_ngcontent-%COMP%]{font-size:.9rem;line-height:.9rem}"],changeDetection:0});let o=i;return o})();var Ti={Results:{en:"Results",ru:"\u0420\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B"},Vote:{en:"Vote",ru:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0434\u0430\u0442\u044B"}};function Cn(o,i){o&1&&y(0,"app-result-view-list")}function bn(o,i){if(o&1&&y(0,"app-result-view-calendar",15),o&2){f();let r=ce(3);u("minDate",r==null?null:r.starts)("maxDate",r==null?null:r.ends)}}var Ns=(()=>{let i=class i{constructor(){this.eventId=D.required(),this.mainInfoComponent=Oe(_t),this.hideIonContent=!0,this.alreadyInit=!1,this.ViewPick=ae,this.VotePageLocalize=Ti,setTimeout(()=>this.hideIonContent=!1,250)}ionViewWillEnter(){this.alreadyInit?this.mainInfoComponent()?.refreshInfo():this.alreadyInit=!0}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-vote-event-page"]],viewQuery:function(t,n){t&1&&Ee(n.mainInfoComponent,_t,5),t&2&&Ve()},hostAttrs:[1,"app-page-inner"],inputs:{eventId:[1,"eventId"]},decls:30,vars:27,consts:[["eventMainInfo",""],["filters",""],["viewPicker",""],["resLoading","appFeatureLoad","result","appResultView"],[1,"ion-padding"],["appFeatureLoad","",3,"eventId"],["mode","ios","value","vote"],["value","info","contentId","info"],["value","vote","contentId","vote"],["mode","ios"],["id","info"],[1,"segment-view-content"],[3,"disabled","maxMembers","maxOverlap"],[3,"refresh","disabled"],["appFeatureLoad","","placeholderOpacity","0.5","appResultView","",3,"viewPick","eventId","min","noMaybe","noTime","onlyWithMe","trimPast"],[3,"minDate","maxDate"],["id","vote"],["appFeatureLoad","","placeholderOpacity","0.5",3,"voteUpdated","eventId","minDate","maxDate"]],template:function(t,n){if(t&1){let c=S();a(0,"ion-content",4),y(1,"app-event-main-info",5,0),je(3),a(4,"ion-segment",6)(5,"ion-segment-button",7)(6,"ion-label"),d(7),m(8,"localize"),l()(),a(9,"ion-segment-button",8)(10,"ion-label"),d(11),m(12,"localize"),l()()(),a(13,"ion-segment-view",9)(14,"ion-segment-content",10)(15,"div",11),y(16,"app-result-filters",12,1),m(18,"async"),a(19,"app-result-view-picker-control",13,2),m(21,"async"),C("refresh",function(){b(c);let h=M(24);return x(h.refresh())}),l(),a(22,"app-result-view-picker-container",14,3),$(25,Cn,1,0,"app-result-view-list")(26,bn,1,2,"app-result-view-calendar",15),l()()(),a(27,"ion-segment-content",16)(28,"div",11)(29,"app-vote-calendar",17),C("voteUpdated",function(h){b(c);let E=M(2),K=M(24);return h.alreadyVoted||E.refreshUsers(),x(K.refresh())}),l()()()()()}if(t&2){let c,p,h=M(2),E=M(17),K=M(20),tt=M(23),Pi=M(24);s(),u("eventId",n.eventId()),s(2);let it=Le(h.info()),Pt=h.users();s(4),g(" ",_(8,19,n.VotePageLocalize.Results)," "),s(4),g(" ",_(12,21,n.VotePageLocalize.Vote)," "),s(5),u("disabled",_(18,23,tt.loading$))("maxMembers",(Pt==null?null:Pt.length)??0)("maxOverlap",(c=Pi.info())==null?null:c.maxOverlap),s(3),u("disabled",_(21,25,tt.loading$)),s(3),u("viewPick",K.value())("eventId",n.eventId())("min",E.membersCount())("noMaybe",E.noMaybe())("noTime",E.noTime())("onlyWithMe",E.onlyWithMe())("trimPast",E.trimPast()),s(3),F((p=K.value())===n.ViewPick.List?25:p===n.ViewPick.Calendar?26:-1),s(4),u("eventId",n.eventId())("minDate",it==null?null:it.starts)("maxDate",it==null?null:it.ends)}},dependencies:[ri,Yt,R,pe,A,Ci,_t,fi,bi,Mi,ki,Si,be,ti,Gt,Jt,Xt,ye],styles:["ion-segment[_ngcontent-%COMP%]{margin:1rem 0 .5rem;background:var(--ion-color-light, #f4f5f8)}ion-segment-view[_ngcontent-%COMP%]{height:auto}ion-segment-content.hide[_ngcontent-%COMP%]{display:none}.segment-view-content[_ngcontent-%COMP%]{padding:.25rem .75rem 1.25rem;display:flex;flex-direction:column;gap:.75rem}"],changeDetection:0});let o=i;return o})();export{Ns as VoteEventPageComponent};
