import{b as ai,c as q}from"./chunk-6IGCFAUU.js";import{a as St,b as he,c as Xe,d as ge,e as U,f as _e,g as ri,h as H}from"./chunk-567XOYJ6.js";import{c as Dt,d as ut,e as wt,g as Ge,h as It,i as Je}from"./chunk-46S35REE.js";import{$ as ke,$b as ii,Aa as je,Ab as Fe,B as v,Ba as Ee,Bb as Qt,C as x,Ca as le,Cb as mt,D as b,Da as oe,Db as Yt,Ea as qe,Fa as m,Ga as _,Gb as K,H as E,Ha as O,Hb as B,I as se,Ia as Nt,Ib as de,Ja as Qe,Jb as ue,K as Ie,Kb as Gt,L as s,La as J,Lb as Jt,Ma as ot,Mb as Xt,Na as Ye,O as T,Oa as D,Ob as dt,Pa as Le,Q as R,Ra as Wt,S as F,Sa as Oe,Sb as Kt,T as Bt,Ta as jt,Tb as fe,Ua as ce,Ub as X,V as zt,Va as pe,Wa as rt,Wb as Zt,X as $,Xb as ei,Y as A,Yb as ti,Z as Se,_ as Te,_a as Re,a as N,aa as u,ac as ft,b as Vt,ba as a,bc as ni,c as Ne,ca as c,da as y,db as qt,dc as oi,e as Et,ea as Ft,fa as $t,g as w,ga as Ct,h as G,ha as k,i as Lt,ia as C,j as W,ja as f,jb as at,k as tt,ka as At,la as Ut,m as We,ma as xt,n as it,na as bt,nb as st,o as Z,oa as Mt,pa as Pe,q as Ot,qa as Ve,qb as lt,r as ae,ra as M,s as ee,sa as Ht,t as I,ta as nt,u as De,ua as d,ub as me,v as V,va as h,vb as Be,w as Rt,wa as j,wb as ct,xa as te,xb as pt,y as we,ya as ie,za as ne,zb as ze}from"./chunk-3L6J7R6N.js";import"./chunk-Q6FFIHTR.js";import"./chunk-7KGURMOZ.js";import"./chunk-NKG53MNX.js";import"./chunk-62TPDNO2.js";import"./chunk-7PWDY3UP.js";import"./chunk-JRYKI6H5.js";import"./chunk-GIIU5PV3.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-SPMQWSIB.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as z,b as Y,f as yt}from"./chunk-2R6CW7ES.js";var si={Search:{en:"Search",ru:"\u041F\u043E\u0438\u0441\u043A"}};var $e=(()=>{let t=class t{set src(e){e?(this.img.src=e,this.showPlaceholder()):this.img.src=this.imgPlaceholder}get img(){return this.elRef.nativeElement}constructor(){this.imgPlaceholder="/assets/no-avatar.png",this.elRef=v(se),this.placeholderEl=this.createPlaceholderEl(),this.img.onload=()=>this.hidePlaceholder()}showPlaceholder(){let e=this.placeholderEl;e.style.width=`${this.img.width+2}px`,e.style.height=`${this.img.offsetHeight+2}px`,e.style.top=`${this.img.offsetTop-1}px`,e.style.left=`${this.img.offsetLeft-1}px`,e.style.borderRadius=window.getComputedStyle(this.img).getPropertyValue("border-radius"),this.img.after(this.placeholderEl)}hidePlaceholder(){this.placeholderEl.remove()}createPlaceholderEl(){let e=document.createElement("div");return e.style.zIndex="1",e.style.position="absolute",e.className="skeleton-placeholder",e}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appImgLoad",""]],inputs:{src:"src",imgPlaceholder:"imgPlaceholder"}});let n=t;return n})();var ve=(()=>{let t=class t{set placeholderOpacity(e){this.placeholderEl.style.opacity=e}get el(){return this.elRef.nativeElement}constructor(){this.elRef=v(se),this.placeholderEl=this.createPlaceholderEl(),this.loadingCounter$=new Vt(0),this.loading$=this.loadingCounter$.pipe(w(e=>e>0),it()),this.destroyed$=new N}ngOnInit(){this.el.style.position="relative",this.loading$.pipe(De(this.destroyed$)).subscribe(e=>e?this.onLoadStarts():this.onLoadEnds())}ngOnDestroy(){this.destroyed$.next(void 0),this.destroyed$.complete()}incrLoading(){this.loadingCounter$.next(this.loadingCounter$.value+1)}decrLoading(){this.loadingCounter$.next(this.loadingCounter$.value-1)}onLoadStarts(){this.el.appendChild(this.placeholderEl)}onLoadEnds(){this.placeholderEl.remove()}createPlaceholderEl(){let e=document.createElement("div");return e.style.zIndex="2",e.style.position="absolute",e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.pointerEvents="none",e.style.borderRadius="0.5rem",e.className="skeleton-placeholder",e}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appFeatureLoad",""]],inputs:{placeholderOpacity:"placeholderOpacity"},exportAs:["appFeatureLoad"]});let n=t;return n})();var Ei=["altLabel"],Li=["end"],li=(n,t)=>({$implicit:n,index:t});function Oi(n,t){if(n&1&&Ct(0,6),n&2){let r=f(),e=r.$implicit,i=r.$index,o=f();u("ngTemplateOutlet",o.altLabelTemplateRef)("ngTemplateOutletContext",qe(2,li,e,i))}}function Ri(n,t){if(n&1&&(a(0,"ion-label"),d(1),c()),n&2){let r=f().$implicit;s(),h(" ",r.fullName," ")}}function Bi(n,t){if(n&1&&Ct(0,6),n&2){let r=f(),e=r.$implicit,i=r.$index,o=f();u("ngTemplateOutlet",o.endTemplateRef)("ngTemplateOutletContext",qe(2,li,e,i))}}function zi(n,t){if(n&1){let r=k();a(0,"ion-item",3),C("click",function(){let i=x(r),o=i.$implicit,l=i.$index,p=f();return b(p.onUserClicked(l,o))}),a(1,"ion-avatar",4),y(2,"img",5),c(),$(3,Oi,1,5,"ng-container",6)(4,Ri,2,1,"ion-label"),$(5,Bi,1,5,"ng-container",6),c()}if(n&2){let r=t.$implicit,e=t.$index,i=t.$count,o=f();u("lines",e===i-1?"none":"")("button",o.clickable()),s(2),u("src",r.photoUrl,Ie),s(),A(o.altLabelTemplateRef?3:4),s(2),A(o.endTemplateRef?5:-1)}}var ht=(()=>{let t=class t{constructor(){this.clickable=D(!1),this.users=D.required(),this.searchStr=E(null),this.filteredUsers=J(()=>{let e=this.users(),i=this.searchStr()?.toLowerCase();return i?e.filter(o=>o.fullName.toLowerCase().includes(i)):e}),this.searchFocused=Ye(),this.userClicked=Ye(),this.UsersListLocalize=si}onUserClicked(e,i){this.clickable()&&this.userClicked.emit({index:e,user:z({},i)})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-users-list"]],contentQueries:function(i,o,l){if(i&1&&(xt(l,Ei,7),xt(l,Li,7)),i&2){let p;bt(p=Mt())&&(o.altLabelTemplateRef=p.first),bt(p=Mt())&&(o.endTemplateRef=p.first)}},inputs:{clickable:[1,"clickable"],users:[1,"users"]},outputs:{searchFocused:"searchFocused",userClicked:"userClicked"},decls:5,vars:4,consts:[["mode","ios","clear-icon","close-outline",3,"ionInput","ionFocus","ionBlur","debounce","placeholder"],["mode","ios"],[3,"lines","button"],[3,"click","lines","button"],["slot","start"],["appImgLoad","",3,"src"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,o){i&1&&(a(0,"ion-searchbar",0),m(1,"localize"),C("ionInput",function(p){return o.searchStr.set(p.detail.value)})("ionFocus",function(){return o.searchFocused.emit(!0)})("ionBlur",function(){return o.searchFocused.emit(!1)}),c(),a(2,"ion-list",1),Te(3,zi,6,5,"ion-item",2,Se),c()),i&2&&(u("debounce",300)("placeholder",_(1,2,o.UsersListLocalize.Search)),s(3),ke(o.filteredUsers()))},dependencies:[rt,jt,U,de,K,ze,B,ei,$e],styles:["[_nghost-%COMP%]{height:100%;position:relative}ion-searchbar[_ngcontent-%COMP%]{position:sticky;top:0}ion-list[_ngcontent-%COMP%]{background:transparent;max-height:calc(100% - 3.75rem);overflow-y:auto}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-label[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}"]});let n=t;return n})();function Fi(n,t){if(n&1&&(a(0,"ion-avatar"),y(1,"img",1),c()),n&2){let r=t.$implicit,e=t.$index,i=t.$count;Ht("z-index",i-e),s(),u("src",r.photoUrl,Ie)}}var ci=(()=>{let t=class t{constructor(){this.users=D.required(),this.maxCount=D(8),this.sliced=J(()=>this.users().slice(0,this.maxCount()))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-avatars-list"]],inputs:{users:[1,"users"],maxCount:[1,"maxCount"]},decls:2,vars:0,consts:[[3,"zIndex"],["appImgLoad","","alt","",3,"src"]],template:function(i,o){i&1&&Te(0,Fi,2,3,"ion-avatar",0,Se),i&2&&ke(o.sliced())},dependencies:[rt,ze,$e],styles:["[_nghost-%COMP%]{display:flex}ion-avatar[_ngcontent-%COMP%]{width:1.6rem;height:1.6rem}ion-avatar[_ngcontent-%COMP%]:not(:last-child){margin-right:-.7rem}"]});let n=t;return n})();var Ae={Member:{en:"member",ru:"\u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A"},Initiator:{en:"Initiator",ru:"\u0418\u043D\u0438\u0446\u0438\u0430\u0442\u043E\u0440"},Starts:{en:"Starts",ru:"\u041D\u0430\u0447\u0430\u043B\u043E"},Ends:{en:"Ends",ru:"\u041A\u043E\u043D\u0435\u0446"},Description:{en:"Description",ru:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},Refresh:{en:"Refresh",ru:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C"},Share:{en:"Share",ru:"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F"},Link:{en:"Link",ru:"\u0421\u0441\u044B\u043B\u043A\u0430"},Edit:{en:"Edit",ru:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"},Delete:{en:"Delete",ru:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"},ClipboardLink:{en:"Link was copied to clipboard",ru:"\u0421\u0441\u044B\u043B\u043A\u0430 \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u0430 \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0435\u043D\u0430"},EventWasDeleted:{en:"Event was successfully deleted",ru:"\u0421\u043E\u0431\u044B\u0442\u0438\u0435 \u0431\u044B\u043B\u043E \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u043E"},DeleteQuestion:{en:"Delete event?",ru:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043E\u0431\u044B\u0442\u0438\u0435?"},CannotBeUndone:{en:"This cannot be undone",ru:"\u042D\u0442\u043E \u043D\u0435\u043B\u044C\u0437\u044F \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"}};var pi=(()=>{let t=class t{constructor(){this.baseUrl="events",this.http=v(Re)}getEventInfo(e){return this.http.get(`${this.baseUrl}/info/${e}`)}getEventUsers(e){return this.http.get(`${this.baseUrl}/users/${e}`)}deleteEvent(e){return this.http.delete(`${this.baseUrl}/${e}`)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var $i=()=>[0,1],mi=()=>[];function Ai(n,t){if(n&1){let r=k();a(0,"ion-item",16),C("click",function(){x(r);let i=f(2);return b(i.redirectToEdit())}),y(1,"ion-icon",20),a(2,"ion-label"),d(3),m(4,"localize"),c()(),a(5,"ion-item",16),C("click",function(){x(r);let i=f(2);return b(i.deleteEvent())}),y(6,"ion-icon",21),a(7,"ion-label",22),d(8),m(9,"localize"),c()()}if(n&2){let r=f(2);u("detail",!1),s(3),h(" ",_(4,4,r.EventMainInfoLocalize.Edit)," "),s(2),u("detail",!1),s(3),h(" ",_(9,6,r.EventMainInfoLocalize.Delete)," ")}}function Ui(n,t){if(n&1){let r=k();a(0,"ion-list",15)(1,"ion-item",16),C("click",function(){x(r);let i=f();return i.refreshInfo(),b(i.refreshUsers())}),y(2,"ion-icon",17),a(3,"ion-label"),d(4),m(5,"localize"),c()(),a(6,"ion-item",16),C("click",function(){x(r);let i=f();return b(i.share())}),y(7,"ion-icon",18),a(8,"ion-label"),d(9),m(10,"localize"),c()(),a(11,"ion-item",16),C("click",function(){x(r);let i=f();return b(i.copyToClipboard())}),y(12,"ion-icon",19),a(13,"ion-label"),d(14),m(15,"localize"),c()(),$(16,Ai,10,8),c()}if(n&2){let r=f(),e=le(0);s(),u("detail",!1),s(3),h(" ",_(5,7,r.EventMainInfoLocalize.Refresh)," "),s(2),u("detail",!1),s(3),h(" ",_(10,9,r.EventMainInfoLocalize.Share)," "),s(2),u("detail",!1),s(3),h(" ",_(15,11,r.EventMainInfoLocalize.Link)," "),s(2),A(e!=null&&e.canEdit?16:-1)}}function Hi(n,t){if(n&1){let r=k();a(0,"ion-item",16),C("click",function(){x(r),f();let i=M(38);return b(i.present())}),a(1,"ion-label"),d(2),m(3,"localizeMany"),c(),y(4,"app-avatars-list",23),c()}if(n&2){let r=f(),e=le(1),i=le(14);u("detail",!1),s(2),j(" ",i," ",O(3,4,r.EventMainInfoLocalize.Member,i)," "),s(2),u("users",e??oe(7,mi))}}function Ni(n,t){if(n&1&&(a(0,"ion-item",13)(1,"ion-label"),d(2),m(3,"localize"),c(),a(4,"ion-note"),d(5),c()()),n&2){let r=f(),e=le(0);s(2),h(" ",_(3,2,r.EventMainInfoLocalize.Description)," "),s(3),h(" ",e==null?null:e.description," ")}}function Wi(n,t){if(n&1&&(a(0,"ion-note",26),d(1),c()),n&2){let r=f().$implicit;s(),h(" ","@"+r.username," ")}}function ji(n,t){if(n&1&&F(0,Wi,2,1,"ion-note",25),n&2){let r=t.$implicit;u("ngIf",r.username)}}function qi(n,t){if(n&1){let r=k();a(0,"app-users-list",24),C("searchFocused",function(i){x(r),f();let o=M(38);return b(o.backdropDismiss=!i)}),F(1,ji,1,1,"ng-template",null,1,Qe),c()}if(n&2){f();let r=le(1);u("users",r??oe(1,mi))}}var gt=(()=>{let t=class t{constructor(){this.eventId=D.required(),this.eventId$=he(this.eventId),this.router=v(qt),this.toast=v(ft),this.confirm=v(oi),this.tg=v(ni),this.request=v(pi),this.featureLoad=v(ve,{optional:!0}),this.refreshInfo$=new N,this.refreshUsers$=new N,this.info$=this.refreshInfo$.pipe(ee(!0),I(()=>this.eventId$),V(()=>this.featureLoad?.incrLoading()),I(e=>this.request.getEventInfo(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),ae(1)),this.users$=this.refreshUsers$.pipe(ee(!0),I(()=>this.eventId$),V(()=>this.featureLoad?.incrLoading()),I(e=>this.request.getEventUsers(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),ae(1)),this.info=Xe(this.info$),this.users=Xe(this.users$),this.local=v(ge),this.EventMainInfoLocalize=Ae}refreshInfo(){this.refreshInfo$.next(!0)}refreshUsers(){this.refreshUsers$.next(!0)}copyToClipboard(){this.tg.getEventTgLink(this.eventId()).pipe(I(e=>Et(navigator.clipboard.writeText(e))),We(1)).subscribe(()=>{let e=this.local.localizeSync(Ae.ClipboardLink);this.toast.light(e,"clipboard-outline")})}share(){this.eventId()&&this.tg.shareEvent(this.eventId(),this.info()?.name)}redirectToEdit(){let e={eventId:this.eventId()};this.router.navigate(["edit"],{queryParams:e})}deleteEvent(){let e=this.local.localizeSync(Ae.DeleteQuestion),i=this.local.localizeSync(Ae.CannotBeUndone),o=this.local.localizeSync(Ae.EventWasDeleted);this.confirm.createConfirm({header:e,message:i}).pipe(tt(Boolean),V(()=>this.featureLoad?.incrLoading()),I(()=>this.request.deleteEvent(this.eventId())),V(()=>this.toast.info(o,"trash-outline")),Z(()=>this.featureLoad?.decrLoading())).subscribe(()=>this.router.navigate(["edit"]))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-event-main-info"]],inputs:{eventId:[1,"eventId"]},decls:40,vars:31,consts:[["usersModal",""],["end",""],["mode","ios"],["value","info"],["slot","header",1,"header-item"],["slot","start"],["appImgLoad","",3,"src"],["id","menu-popover-trigger","slot","end","color","dark","fill","clear","size","large",1,"menu-button",3,"click"],["name","ellipsis-vertical","slot","icon-only"],["mode","ios","trigger","menu-popover-trigger","triggerAction","click",3,"dismissOnSelect","arrow"],["slot","content","mode","ios",1,"info-list"],["button","",3,"detail"],[3,"lines"],["lines","none",1,"notes-item"],[3,"initialBreakpoint","breakpoints"],["lines","none",1,"popover-menu-list"],["button","",3,"click","detail"],["name","refresh-outline","slot","start","color","medium"],["name","share-social-outline","slot","start","color","medium"],["name","link-outline","slot","start","color","medium"],["name","create-outline","slot","start","color","medium"],["name","trash-outline","slot","start","color","danger"],["color","danger"],[3,"users"],[3,"searchFocused","users"],["class","username",4,"ngIf"],[1,"username"]],template:function(i,o){if(i&1){let l=k();je(0)(1),a(2,"ion-accordion-group",2)(3,"ion-accordion",3)(4,"ion-item",4)(5,"ion-avatar",5),y(6,"img",6),c(),a(7,"ion-label"),d(8),c(),a(9,"ion-button",7),C("click",function(g){return x(l),b(g.stopPropagation())}),y(10,"ion-icon",8),c(),a(11,"ion-popover",9),F(12,Ui,17,13,"ng-template"),c()(),a(13,"ion-list",10),je(14),$(15,Hi,5,8,"ion-item",11),a(16,"ion-item")(17,"ion-label"),d(18),m(19,"localize"),c(),a(20,"ion-note"),d(21),c()(),a(22,"ion-item")(23,"ion-label"),d(24),m(25,"localize"),c(),a(26,"ion-note"),d(27),m(28,"date"),c()(),a(29,"ion-item",12)(30,"ion-label"),d(31),m(32,"localize"),c(),a(33,"ion-note"),d(34),m(35,"date"),c()(),$(36,Ni,6,4,"ion-item",13),c()()(),a(37,"ion-modal",14,0),F(39,qi,3,2,"ng-template"),c()}if(i&2){let l=Ee(o.info());s();let p=Ee(o.users());s(5),u("src",l==null||l.creator==null?null:l.creator.photoUrl,Ie),s(2),h(" ",(l==null?null:l.name)??"Event name"," "),s(3),u("dismissOnSelect",!0)("arrow",!1),s(3);let g=Ee((p==null?null:p.length)??0);s(),A(g>0?15:-1),s(3),h(" ",_(19,18,o.EventMainInfoLocalize.Initiator)," "),s(3),h(" ",l==null||l.creator==null?null:l.creator.fullName," "),s(3),h(" ",_(25,20,o.EventMainInfoLocalize.Starts)," "),s(3),h(" ",O(28,22,l==null?null:l.starts,"dd.MM.yyyy")," "),s(2),u("lines",l!=null&&l.description?"":"none"),s(2),h(" ",_(32,25,o.EventMainInfoLocalize.Ends)," "),s(3),h(" ",O(35,27,l==null?null:l.ends,"dd.MM.yyyy")," "),s(2),A(l!=null&&l.description?36:-1),s(),u("initialBreakpoint",1)("breakpoints",oe(30,$i))}},dependencies:[H,Oe,B,Fe,X,de,K,ue,pe,U,_e,pt,ct,ze,me,Be,ci,ht,$e],styles:["ion-accordion-group[_ngcontent-%COMP%]{border-radius:.5rem}ion-list.info-list[_ngcontent-%COMP%]{margin-top:.5rem;background:transparent}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item.header-item[_ngcontent-%COMP%]{border-radius:.5rem;--padding-start: .75rem;--min-height: 3.7rem}ion-item.header-item[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:2.75rem!important;height:2.75rem!important}ion-item.header-item[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{margin-right:-1rem}ion-item.header-item[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}ion-item.header-item[_ngcontent-%COMP%]     .ion-accordion-toggle-icon{position:absolute;right:3rem}ion-item.notes-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-bottom:auto}ion-item.notes-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{padding:.5rem 0;margin-left:max(20%,2.5rem);text-align:end}ion-popover[_ngcontent-%COMP%]{--offset-y: -.25rem;--offset-x: -.6rem;--width: auto}ion-popover[_ngcontent-%COMP%]   .popover-menu-list[_ngcontent-%COMP%]{padding:.25rem 0;background-color:var(--ion-background-color-step-100);white-space:nowrap}app-avatars-list[_ngcontent-%COMP%]{opacity:.9}ion-modal[_ngcontent-%COMP%]{--height: auto}ion-modal[_ngcontent-%COMP%]   app-users-list[_ngcontent-%COMP%]{height:60vh;padding:1rem}"],changeDetection:0});let n=t;return n})();var di={FilterResults:{en:"Filter results",ru:"\u0424\u0438\u043B\u044C\u0442\u0440\u043E\u0432\u0430\u0442\u044C \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B"},Exclude:{en:"Exclude",ru:"\u0418\u0441\u043A\u043B\u044E\u0447\u0438\u0442\u044C "},Maybe:{en:'"maybe"',ru:'"\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E"'},Time:{en:'"time"',ru:'"\u0432\u0440\u0435\u043C\u044F"'},IgnorePastDates:{en:"Ignore past dates",ru:"\u0423\u0431\u0440\u0430\u0442\u044C \u043F\u0440\u043E\u0448\u0435\u0434\u0448\u0438\u0435 \u0434\u0430\u0442\u044B"},OnlyWithMe:{en:"Only with me",ru:"\u0422\u043E\u043B\u044C\u043A\u043E \u0441\u043E \u043C\u043D\u043E\u0439"},AtLeast:{en:"At least",ru:"\u041A\u0430\u043A \u043C\u0438\u043D\u0438\u043C\u0443\u043C"},Member:{en:"member",ru:"\u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A"}};var ui=yt(St());var fi=(()=>{let t=class t{set maxOverlap(e){(0,ui.isNil)(e)||this.membersCount.set(e)}constructor(){this.disabled=!1,this.noMaybe=E(!1),this.noTime=E(!1),this.onlyWithMe=E(!1),this.trimPast=E(!0),this.membersCount=E(1),this.ResultFiltersLocalize=di}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-result-filters"]],inputs:{disabled:"disabled",maxMembers:"maxMembers",maxOverlap:"maxOverlap"},decls:38,vars:40,consts:[["mode","ios"],["value","filters","toggleIcon","remove-outline"],["slot","header",1,"header-item"],["slot","content","mode","ios"],[3,"ngModelChange","ngModel"],["color","warning"],["color","success"],["lines","none"],["lines","none",1,"range-list-item"],[3,"ngModelChange","ngModel","snaps","min","max","ticks"]],template:function(i,o){i&1&&(a(0,"ion-accordion-group",0)(1,"ion-accordion",1)(2,"ion-item",2)(3,"ion-label"),d(4),m(5,"localize"),c()(),a(6,"ion-list",3)(7,"ion-item")(8,"ion-checkbox",4),ne("ngModelChange",function(p){return ie(o.noMaybe,p)||(o.noMaybe=p),p}),d(9),m(10,"localize"),a(11,"ion-text",5),d(12),m(13,"localize"),c()()(),a(14,"ion-item")(15,"ion-checkbox",4),ne("ngModelChange",function(p){return ie(o.noTime,p)||(o.noTime=p),p}),d(16),m(17,"localize"),a(18,"ion-text",6),d(19),m(20,"localize"),c()()(),a(21,"ion-item")(22,"ion-checkbox",4),ne("ngModelChange",function(p){return ie(o.onlyWithMe,p)||(o.onlyWithMe=p),p}),d(23),m(24,"localize"),c()(),a(25,"ion-item")(26,"ion-checkbox",4),ne("ngModelChange",function(p){return ie(o.trimPast,p)||(o.trimPast=p),p}),d(27),m(28,"localize"),c()(),a(29,"ion-item",7)(30,"ion-label"),d(31),m(32,"localize"),c(),a(33,"ion-note"),d(34),m(35,"localizeMany"),c()(),a(36,"ion-item",8)(37,"ion-range",9),ne("ngModelChange",function(p){return ie(o.membersCount,p)||(o.membersCount=p),p}),c()()()()()),i&2&&(nt("disabled",o.disabled),s(4),h(" ",_(5,21,o.ResultFiltersLocalize.FilterResults)," "),s(4),te("ngModel",o.noMaybe),s(),h(" ",_(10,23,o.ResultFiltersLocalize.Exclude)," "),s(3),h(" ",_(13,25,o.ResultFiltersLocalize.Maybe)," "),s(3),te("ngModel",o.noTime),s(),h(" ",_(17,27,o.ResultFiltersLocalize.Exclude)," "),s(3),h(" ",_(20,29,o.ResultFiltersLocalize.Time)," "),s(3),te("ngModel",o.onlyWithMe),s(),h(" ",_(24,31,o.ResultFiltersLocalize.OnlyWithMe)," "),s(3),te("ngModel",o.trimPast),s(),h(" ",_(28,33,o.ResultFiltersLocalize.IgnorePastDates)," "),s(4),h(" ",_(32,35,o.ResultFiltersLocalize.AtLeast)," "),s(3),j(" ",o.membersCount()," ",O(35,37,o.ResultFiltersLocalize.Member,o.membersCount())," "),s(3),te("ngModel",o.membersCount),u("snaps",!0)("min",1)("max",o.maxMembers)("ticks",o.maxMembers<=10))},dependencies:[H,B,de,K,ue,dt,U,_e,pt,ct,Kt,Zt,lt,at,st],styles:[".disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}ion-accordion[_ngcontent-%COMP%]{background:var(--ion-color-light, #f4f5f8);border-radius:.5rem;--padding-end: 0}.header-item[_ngcontent-%COMP%]{--inner-padding-end: .9rem}ion-list[_ngcontent-%COMP%]{background:var(--ion-color-light, #f4f5f8)}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{opacity:.85}ion-item[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{--knob-size: 22px}ion-item.range-list-item[_ngcontent-%COMP%]{margin-top:-.65rem;--padding-start: 1px;--inner-padding-end: .2rem}"]});let n=t;return n})();var hi=(()=>{let t=class t{constructor(){this.popover=v(Be),this.destroyed$=new N}ngOnInit(){this.popover.willPresent.pipe(tt(e=>!!e.target),I(e=>G(e.target,"contextmenu")),De(this.destroyed$)).subscribe(e=>e.preventDefault())}ngOnDestroy(){this.destroyed$.next(void 0),this.destroyed$.complete()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appPreventContext",""]]});let n=t;return n})();var S=function(n){return n.Ready="ready",n.Maybe="maybe",n.Time="time",n}(S||{});var gi=yt(St());var Ue=(()=>{let t=class t{set voteDates(e){let i=(0,gi.groupBy)(e,"voteType"),o=i[S.Ready]??[],l=i[S.Maybe]??[],p=i[S.Time]??[];this.readyDates.set(new Set(o.map(g=>this.formatVoteDate(g.date)))),this.maybeDates.set(new Set(l.map(g=>this.formatVoteDate(g.date)))),this.timeDates.set(new Map(p.map(g=>[this.formatVoteDate(g.date),g])))}get voteDates(){let e=this.readyDates(),i=this.maybeDates(),o=this.timeDates();return[...Array.from(e).map(l=>({date:new Date(l),voteType:S.Ready})),...Array.from(i).map(l=>({date:new Date(l),voteType:S.Maybe})),...Array.from(o.values())]}get rootEl(){return this.elRef.nativeElement.shadowRoot}constructor(){this.readyDates=E(new Set),this.maybeDates=E(new Set),this.timeDates=E(new Map),this.lastFocusedDateButton$=new Ne(1),this.focusedTimeChanges=this.lastFocusedDateButton$.pipe(w(e=>{if(!e)return;let i=Number(e.getAttribute("data-day")),o=Number(e.getAttribute("data-month")),l=Number(e.getAttribute("data-year")),p=new Date(l,o-1,i);return this.timeDates().get(this.formatVoteDate(p))})),this.ionDateComponent=v(fe),this.elRef=v(se),this.rootObs=new MutationObserver(()=>{let e=this.rootEl.querySelectorAll("button.calendar-day");this.dateButtons$.next(Array.from(e))}),this.dateButtons$=new Ne(1),ot(()=>{let e=this.readyDates(),i=this.maybeDates(),o=this.timeDates();this.ionDateComponent.highlightedDates=[...Array.from(e).map(l=>({date:l,textColor:"var(--ready-text-color)",backgroundColor:"var(--ready-bg-color)"})),...Array.from(i).map(l=>({date:l,textColor:"var(--maybe-text-color)",backgroundColor:"var(--maybe-bg-color)"})),...Array.from(o.keys()).map(l=>({date:l,textColor:"var(--time-text-color)",backgroundColor:"var(--time-bg-color)"}))]})}ngAfterViewInit(){this.rootObs.observe(this.rootEl,{childList:!0,subtree:!0})}ngOnDestroy(){this.dateButtons$.complete(),this.rootObs.disconnect()}emitAllDatesSignals(){this.readyDates.set(new Set(this.readyDates())),this.maybeDates.set(new Set(this.maybeDates())),this.timeDates.set(new Map(this.timeDates()))}formatVoteDate(e){return q(e,"yyyy-MM-dd")}getDataFromButton(e){let i=Number(e.getAttribute("data-day")),o=Number(e.getAttribute("data-month")),l=Number(e.getAttribute("data-year"));return{day:i,month:o,year:l}}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appVoteData",""]],inputs:{voteDates:"voteDates"},outputs:{focusedTimeChanges:"focusedTimeChanges"},exportAs:["appVoteData"]});let n=t;return n})();var _i=(()=>{let t=class t{constructor(){this.data=v(Ue)}ngAfterViewInit(){this.data.dateButtons$.pipe(I(e=>{let i=e.map(o=>G(o,"click",{capture:!0}).pipe(V(l=>l.stopPropagation()),w(()=>o)));return W(...i)})).subscribe(e=>this.handleClick(e))}handleClick(e){let{day:i,month:o,year:l}=this.data.getDataFromButton(e),p=this.data.formatVoteDate(new Date(l,o-1,i)),g=this.data.readyDates(),P=this.data.maybeDates(),Q=this.data.timeDates();g.has(p)?g.delete(p):P.has(p)?P.delete(p):Q.has(p)?Q.delete(p):g.add(p),this.data.emitAllDatesSignals()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appVoteHandleClick",""]]});let n=t;return n})();var vi=(n,t=500)=>{let r=G(n,"touchstart"),e=G(n,"touchend"),i=G(n,"touchmove");return r.pipe(I(o=>Lt(t).pipe(w(()=>o),De(W(e,i)))))};var ye=class{static toJsDates(t){return Y(z({},t),{date:new Date(t.date),start:t.start?new Date(t.start):void 0,end:t.end?new Date(t.end):void 0})}static toStringDates(t){return Y(z({},t),{date:q(t.date,"yyyy-MM-dd"),start:t.start?q(t.start,"yyyy-MM-dd'T'HH:mm:ss"):void 0,end:t.end?q(t.end,"yyyy-MM-dd'T'HH:mm:ss"):void 0})}};var yi=(()=>{let t=class t{constructor(){this.data=v(Ue)}ngAfterViewInit(){this.data.dateButtons$.pipe(I(e=>{let i=e.map(o=>{let l=G(o,"contextmenu"),p=vi(o);return W(l,p).pipe(V(g=>g.preventDefault()),w(g=>Y(z({},g),{target:o})),Rt(500))});return W(...i)})).subscribe(e=>this.showPopover(e))}showPopover(e){let i=e.target;this.appVoteHandlePopover.present(e),this.appVoteHandlePopover.willPresent.pipe(We(1)).subscribe(()=>{this.data.lastFocusedDateButton$.next(i),i.style.opacity="0.65"}),this.appVoteHandlePopover.willDismiss.pipe(We(1)).subscribe(o=>{if(this.data.lastFocusedDateButton$.next(void 0),i.style.opacity="",o.detail.data){let{day:l,month:p,year:g}=this.data.getDataFromButton(i);this.handlePopoverButtons(o.detail.data,g,p,l)}})}handlePopoverButtons(e,i,o,l){let p=new Date(i,o-1,l),g=this.data.formatVoteDate(p);if(e.ready)this.data.readyDates().add(g),this.data.maybeDates().delete(g),this.data.timeDates().delete(g);else if(e.maybe)this.data.maybeDates().add(g),this.data.readyDates().delete(g),this.data.timeDates().delete(g);else if(e.time){let P=new Date(e.start),Q=new Date(e.end);P.setFullYear(i,o-1,l),Q.setFullYear(i,o-1,l);let Ze={date:p,voteType:S.Time,start:P,end:Q};this.data.timeDates().set(g,Ze),this.data.readyDates().delete(g),this.data.maybeDates().delete(g)}this.data.emitAllDatesSignals()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appVoteHandlePopover",""]],inputs:{appVoteHandlePopover:"appVoteHandlePopover"}});let n=t;return n})();var kt={Ready:{en:"Ready",ru:"\u0413\u043E\u0442\u043E\u0432"},Maybe:{en:"Maybe",ru:"\u0412\u043E\u0437\u043C\u043E\u0436\u043D\u043E"},Time:{en:"Time",ru:"\u0412\u0440\u0435\u043C\u044F"},HoldDate:{en:"Hold date",ru:"\u0423\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u0430\u0442\u0443,"},RightClickDate:{en:"Right click on date",ru:"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u043F\u0440\u0430\u0432\u043E\u0439 \u043A\u043D\u043E\u043F\u043A\u043E\u0439 \u043C\u044B\u0448\u0438 \u043F\u043E \u0434\u0430\u0442\u0435,"},SelectSpecificStatus:{en:"to select specific status",ru:"\u0447\u0442\u043E\u0431\u044B \u0432\u044B\u0431\u0440\u0430\u0442\u044C \u0441\u0442\u0430\u0442\u0443\u0441"},DoNotForgetSave:{en:"Don't forget to save changes",ru:"\u041D\u0435 \u0437\u0430\u0431\u0443\u0434\u044C\u0442\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F"},Clear:{en:"Clear",ru:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C"},Cancel:{en:"Cancel",ru:"\u041E\u0442\u043C\u0435\u043D\u0430"},Save:{en:"Save",ru:"\u0413\u043E\u0442\u043E\u0432\u043E"},StartTime:{en:"Start time",ru:"\u0412\u0440\u0435\u043C\u044F \u043D\u0430\u0447\u0430\u043B\u0430"},EndTime:{en:"End time",ru:"\u0412\u0440\u0435\u043C\u044F \u043E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u044F"},SpecifyTime:{en:"Specify time",ru:"\u0423\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0440\u0435\u043C\u044F"},HasBeenSaved:{en:"All changes have been saved successfully",ru:"\u0412\u0441\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B"}};var Ci=(()=>{let t=class t{constructor(){this.baseUrl="votes",this.http=v(Re)}getEventVote(e){let i={eventId:e};return this.http.get(this.baseUrl,{params:i}).pipe(w(o=>{let l=o.dates.map(p=>ye.toJsDates(p));return Y(z({},o),{dates:l})}))}updateEventVote(e,i){let l={dates:i.map(g=>ye.toStringDates(g))},p={eventId:e};return this.http.post(this.baseUrl,l,{params:p}).pipe(w(g=>{let P=g.dates.map(Q=>ye.toJsDates(Q));return Y(z({},g),{dates:P})}))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var Yi=()=>[],Gi=()=>[0,1];function Ji(n,t){if(n&1){let r=k();a(0,"div",24)(1,"ion-button",25,3),C("click",function(){x(r),f();let i=M(41);return b(i.dismiss({ready:!0}))}),y(3,"ion-icon",26),c(),a(4,"ion-button",27,4),C("click",function(){x(r),f();let i=M(41);return b(i.dismiss({maybe:!0}))}),y(6,"ion-icon",28),c(),a(7,"ion-button",29,5),C("click",function(){x(r),f();let i=M(44);return b(i.present())}),y(9,"ion-icon",30),c()()}}function Xi(n,t){if(n&1){let r=k();a(0,"div",31)(1,"div",32)(2,"div",33)(3,"ion-label"),d(4),m(5,"localize"),c(),a(6,"ion-datetime",34),ne("ngModelChange",function(i){x(r);let o=f();return ie(o.startTime,i)||(o.startTime=i),b(i)}),c()(),a(7,"div",33)(8,"ion-label"),d(9),m(10,"localize"),c(),a(11,"ion-datetime",34),ne("ngModelChange",function(i){x(r);let o=f();return ie(o.endTime,i)||(o.endTime=i),b(i)}),c()()(),a(12,"ion-button",35),C("click",function(){x(r);let i=f(),o=M(41);return M(44).dismiss(),i.lastAppliedStartTime=i.startTime(),i.lastAppliedEndTime=i.endTime(),b(o.dismiss({time:!0,start:i.startTime(),end:i.endTime()}))}),d(13),m(14,"localize"),c()()}if(n&2){let r=f();s(4),h(" ",_(5,6,r.VoteCalendarLocalize.StartTime)," "),s(2),te("ngModel",r.startTime),s(3),h(" ",_(10,8,r.VoteCalendarLocalize.EndTime)," "),s(2),te("ngModel",r.endTime),s(),u("disabled",r.isTimeInvalid()),s(),h(" ",_(14,10,r.VoteCalendarLocalize.SpecifyTime)," ")}}var _t="yyyy-MM-dd'T'HH:mm:ss",xi=(()=>{let t=class t{constructor(){this.eventId=D.required(),this.minDate=D(),this.maxDate=D(),this.voteUpdated=Ye(),this.resetDates$=new N,this.clearDates$=new N,this.saveDates$=new N,this.request=v(Ci),this.featureLoad=v(ve,{optional:!0}),this.loadedEventVote$=he(this.eventId).pipe(V(()=>this.featureLoad?.incrLoading()),I(e=>this.request.getEventVote(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),ae(1)),this.updatedEventVote$=this.saveDates$.pipe(V(()=>this.featureLoad?.incrLoading()),I(e=>this.request.updateEventVote(this.eventId(),e).pipe(Z(()=>this.featureLoad?.decrLoading()))),V(e=>this.voteUpdated.emit(e)),V(()=>{let e=this.loc.localizeSync(kt.HasBeenSaved);this.toast.info(e,"cloud-done-outline")}),ae(1)),this.voteDates$=W(this.clearDates$.pipe(w(()=>[])),this.resetDates$.pipe(ee(!0),I(()=>W(this.loadedEventVote$,this.updatedEventVote$)),w(e=>e.dates.slice()))),this.startTime=E(q(new Date,_t)),this.endTime=E(q(new Date,_t)),this.lastAppliedStartTime=this.startTime(),this.lastAppliedEndTime=this.endTime(),this.isTimeInvalid=J(()=>{let e=new Date(this.startTime()),i=new Date(this.endTime());return e>=i}),this.toast=v(ft),this.tools=v(ii),this.isTouchDevice=this.tools.isTouchDevice,this.loc=v(ge),this.localizeFormat$=this.loc.localizationWithFormat$,this.VoteCalendarLocalize=kt}updateTime(e){let i=e?.start?q(e.start,_t):this.lastAppliedStartTime,o=e?.end?q(e.end,_t):this.lastAppliedEndTime;this.startTime.set(i),this.endTime.set(o)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-vote-calendar"]],inputs:{eventId:[1,"eventId"],minDate:[1,"minDate"],maxDate:[1,"maxDate"]},outputs:{voteUpdated:"voteUpdated"},decls:46,vars:42,consts:[["appVoteData","appVoteData"],["popover",""],["timeModal",""],["readyButton",""],["maybeButton",""],["timeButton",""],[1,"vote-calendar"],[1,"vote-calendar-header"],[1,"chips"],["color","primary",1,"ion-activated"],["name","checkmark-outline"],["color","warning",1,"ion-activated"],["name","help-outline"],["color","success",1,"ion-activated"],["name","time-outline"],[1,"subtitle"],["appVoteData","","appVoteHandleClick","","presentation","date","mode","ios",3,"focusedTimeChanges","appVoteHandlePopover","voteDates","firstDayOfWeek","min","max","locale"],["mode","ios",1,"vote-calendar-actions"],["color","medium",3,"click"],[1,"right"],["color","danger",3,"click"],["color","primary",3,"click"],["appPreventContext","","mode","ios","side","top","alignment","center",3,"arrow"],[3,"initialBreakpoint","breakpoints"],[1,"popover-content"],["size","small","color","primary",3,"click"],["name","checkmark-outline","slot","icon-only"],["size","small","color","warning",3,"click"],["name","help-outline","slot","icon-only"],["size","small","color","success",3,"click"],["name","time-outline","slot","icon-only"],[1,"time-modal-content"],[1,"time-pickers"],[1,"pick"],["presentation","time","mode","ios",3,"ngModelChange","ngModel"],["mode","ios",3,"click","disabled"]],template:function(i,o){if(i&1){let l=k();a(0,"div",6)(1,"div",7)(2,"div",8)(3,"ion-chip",9),y(4,"ion-icon",10),a(5,"ion-label"),d(6),m(7,"localize"),c()(),a(8,"ion-chip",11),y(9,"ion-icon",12),a(10,"ion-label"),d(11),m(12,"localize"),c()(),a(13,"ion-chip",13),y(14,"ion-icon",14),a(15,"ion-label"),d(16),m(17,"localize"),c()()(),a(18,"span",15),d(19),m(20,"localize"),m(21,"localize"),y(22,"br"),d(23),m(24,"localize"),c()(),a(25,"ion-datetime",16,0),m(27,"async"),m(28,"async"),C("focusedTimeChanges",function(g){return x(l),b(o.updateTime(g))}),c(),a(29,"ion-buttons",17)(30,"ion-button",18),C("click",function(){return x(l),b(o.clearDates$.next(!0))}),d(31),m(32,"localize"),c(),a(33,"div",19)(34,"ion-button",20),C("click",function(){return x(l),b(o.resetDates$.next(!0))}),d(35),m(36,"localize"),c(),a(37,"ion-button",21),C("click",function(){x(l);let g=M(26);return b(o.saveDates$.next(g.voteDates))}),d(38),m(39,"localize"),c()()()(),a(40,"ion-popover",22,1),F(42,Ji,10,0,"ng-template"),c(),a(43,"ion-modal",23,2),F(45,Xi,15,12,"ng-template"),c()}if(i&2){let l=M(41);s(6),h(" ",_(7,18,o.VoteCalendarLocalize.Ready)," "),s(5),h(" ",_(12,20,o.VoteCalendarLocalize.Maybe)," "),s(5),h(" ",_(17,22,o.VoteCalendarLocalize.Time)," "),s(3),j(" ",_(20,24,o.isTouchDevice?o.VoteCalendarLocalize.HoldDate:o.VoteCalendarLocalize.RightClickDate)," ",_(21,26,o.VoteCalendarLocalize.SelectSpecificStatus)," "),s(4),h(" ",_(24,28,o.VoteCalendarLocalize.DoNotForgetSave)," "),s(2),u("appVoteHandlePopover",l)("voteDates",_(27,30,o.voteDates$)??oe(40,Yi))("firstDayOfWeek",1)("min",o.minDate()??void 0)("max",o.maxDate()??void 0)("locale",_(28,32,o.localizeFormat$)),s(6),h(" ",_(32,34,o.VoteCalendarLocalize.Clear)," "),s(4),h(" ",_(36,36,o.VoteCalendarLocalize.Cancel)," "),s(3),h(" ",_(39,38,o.VoteCalendarLocalize.Save)," "),s(2),u("arrow",!0),s(3),u("initialBreakpoint",1)("breakpoints",oe(41,Gi))}},dependencies:[H,B,Fe,Qt,X,ce,U,fe,mt,Be,me,lt,at,st,Ue,_i,yi,hi],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%}.vote-calendar-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;background-color:var(--ion-color-light, #f4f5f8);padding:.5rem .5rem .25rem;border-top-left-radius:.5rem;border-top-right-radius:.5rem}.vote-calendar-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{padding:0 .5rem;color:var(--ion-text-color-step-600, #b3b3b3);font-size:.9rem;line-height:1.25rem;margin-top:.125rem;margin-bottom:1rem}.vote-calendar-header[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{display:flex;padding:0 .2rem;justify-content:space-between;gap:.25rem}.vote-calendar-header[_ngcontent-%COMP%]   .ion-activated[_ngcontent-%COMP%]{pointer-events:none}.vote-calendar-actions[_ngcontent-%COMP%]{padding:.5rem .75rem;background-color:var(--ion-color-light, #f4f5f8);justify-content:space-between;border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem;gap:1rem}.vote-calendar-actions[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;gap:.5rem}ion-datetime[_ngcontent-%COMP%]{border-radius:0}ion-popover[_ngcontent-%COMP%]{--offset-y: -.15rem;--width: 8rem}.popover-content[_ngcontent-%COMP%]{padding:.5rem;width:100%;display:flex;justify-content:space-between;gap:.25rem;opacity:.95}ion-modal[_ngcontent-%COMP%]{--height: auto}.time-modal-content[_ngcontent-%COMP%]{padding:1.5rem;display:flex;flex-direction:column;gap:1rem}.time-modal-content[_ngcontent-%COMP%]   .time-pickers[_ngcontent-%COMP%]{display:flex;gap:1rem}.time-modal-content[_ngcontent-%COMP%]   .time-pickers[_ngcontent-%COMP%]   .pick[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;gap:1rem}.time-modal-content[_ngcontent-%COMP%]   .time-pickers[_ngcontent-%COMP%]   .pick[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{width:100%;border-radius:1rem}"],changeDetection:0});let n=t;return n})();var re=function(n){return n.List="list",n.Calendar="calendar",n}(re||{});var bi=(()=>{let t=class t{constructor(){this.disabled=!1,this.ViewPick=re,this.value=E(re.List),this.refresh=new Bt}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-result-view-picker-control"]],inputs:{disabled:"disabled"},outputs:{refresh:"refresh"},decls:7,vars:3,consts:[[1,"picker",3,"ngClass"],[1,"item",3,"click"],["name","list-outline"],["name","calendar-outline"],[3,"click"],["slot","icon-only","name","refresh-outline"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"div",1),C("click",function(){return o.value.set(o.ViewPick.List)}),y(2,"ion-icon",2),c(),a(3,"div",1),C("click",function(){return o.value.set(o.ViewPick.Calendar)}),y(4,"ion-icon",3),c()(),a(5,"ion-button",4),C("click",function(){return o.refresh.emit()}),y(6,"ion-icon",5),c()),i&2&&(nt("disabled",o.disabled),u("ngClass",o.value()))},dependencies:[H,Wt,Fe,X],styles:['[_nghost-%COMP%]{display:flex;justify-content:space-between;align-items:center}.picker[_ngcontent-%COMP%]{position:relative;display:flex;border-radius:.5rem;background-color:var(--ion-color-light, #f4f5f8);--border-size: 2px}.picker.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.picker[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{z-index:2;padding:.8rem 1.25rem;display:flex;align-items:center;cursor:pointer}.picker[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{opacity:.7}.picker[_ngcontent-%COMP%]:after{content:"";transition:left .2s ease-in-out;z-index:1;position:absolute;top:var(--border-size);bottom:var(--border-size);width:calc(50% - var(--border-size) * 2);box-shadow:var(--picker-box-shadow);background-color:var(--ion-background-color-step-350, #fff);border-radius:.5rem}.picker.list[_ngcontent-%COMP%]:after{left:var(--border-size)!important}.picker.calendar[_ngcontent-%COMP%]:after{left:calc(50% + var(--border-size))!important}ion-button[_ngcontent-%COMP%]{margin:0;--border-radius: .5rem;--padding-bottom: .75rem;--padding-end: .75rem;--padding-start: .75rem;--padding-top: .75rem}']});let n=t;return n})();var Ki=["*"],Zi=(n,t)=>({value:n,params:t}),Mi="0.4s ease-in-out",en={transform:"translateX(0)"},tn={transform:"translateX({{ leaveEnd }}%)"},nn={transform:"translateX({{ enterStart }}%)"},Di=(()=>{let t=class t{constructor(){this.viewPick=D.required(),this.animationDisabled=E(!0),this.animationParams=J(()=>{switch(this.viewPick()){case re.List:return{leaveEnd:120,enterStart:-120};case re.Calendar:return{leaveEnd:-120,enterStart:120};default:return{}}}),zt(()=>{this.animationDisabled()&&this.animationDisabled.set(!1)})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-result-view-picker-container"]],inputs:{viewPick:[1,"viewPick"]},ngContentSelectors:Ki,decls:2,vars:5,consts:[[1,"result-view-picker-container-animated"]],template:function(i,o){i&1&&(At(),a(0,"div",0),Ut(1),c()),i&2&&u("@.disabled",o.animationDisabled())("@openCloseResultView",qe(2,Zi,o.viewPick(),o.animationParams()))},styles:[".result-view-picker-container-animated[_ngcontent-%COMP%]{display:grid;overflow:hidden;place-items:start}  .result-view-picker-container-animated>*{display:block;grid-column:1;grid-row:1;width:100%}"],data:{animation:[Dt("openCloseResultView",[It("* => *",[wt([Je(":enter",Ge(nn)),Je(":leave",[ut(Mi,Ge(tn))],{optional:!0}),Je(":enter",[ut(Mi),Ge(en)])])],{params:{leaveEnd:-120,enterStart:120}})])]},changeDetection:0});let n=t;return n})();var wi=(()=>{let t=class t{constructor(){this.baseUrl="results",this.http=v(Re)}getEventResults(e){let i={eventId:e};return this.http.get(this.baseUrl,{params:i}).pipe(w(o=>{let l=o.dates.map(p=>ye.toJsDates(p));return Y(z({},o),{dates:l})}))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=we({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var on=ai(new Date),Ce=(()=>{let t=class t{constructor(){this.eventId=D.required(),this.min=D.required(),this.noMaybe=D.required(),this.noTime=D.required(),this.onlyWithMe=D.required(),this.trimPast=D.required(),this.request=v(wi),this.featureLoad=v(ve,{optional:!0}),this.refresh$=new N,this.eventid$=he(this.eventId),this.info$=this.refresh$.pipe(ee(!0),I(()=>this.eventid$),V(()=>this.featureLoad?.incrLoading()),I(e=>this.request.getEventResults(e).pipe(Z(()=>this.featureLoad?.decrLoading()))),ae(1)),this.info=Xe(this.info$),this.dates=J(()=>this.info()?.dates??[]),this.filteredDates=J(()=>this.dates().filter(e=>e.users.length>=this.min()&&(!this.trimPast()||e.date>=on)&&(!this.noMaybe()||e.voteType!==S.Maybe)&&(!this.noTime()||e.voteType!==S.Time)&&(!this.onlyWithMe()||e.isWithMe))),this.filteredDatesMap=J(()=>{let e=this.filteredDates();return new Map(e.map(i=>[this.formatVoteDate(i.date),i]))})}refresh(){this.refresh$.next(!0)}formatVoteDate(e){return q(e,"yyyy-MM-dd")}getVoteDate(e){let i=this.formatVoteDate(e);return this.filteredDatesMap().get(i)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appResultView",""]],inputs:{eventId:[1,"eventId"],min:[1,"min"],noMaybe:[1,"noMaybe"],noTime:[1,"noTime"],onlyWithMe:[1,"onlyWithMe"],trimPast:[1,"trimPast"]},exportAs:["appResultView"]});let n=t;return n})();var Si=yt(St());var xe=class{static getColorByType(t){switch(t){case S.Ready:return"primary";case S.Maybe:return"warning";case S.Time:return"success"}}static getIconByType(t){switch(t){case S.Ready:return"checkmark-outline";case S.Maybe:return"help-outline";case S.Time:return"time-outline"}}};var He={Member:{en:"member",ru:"\u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A"},NoData:{en:"No data, try to change filters",ru:"\u041F\u0443\u0441\u0442\u043E, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0444\u0438\u043B\u044C\u0442\u0440\u044B"},NoTimeOverlap:{en:"No time overlap",ru:"\u041D\u0435\u0442 \u043E\u0431\u0449\u0435\u0433\u043E \u0432\u0440\u0435\u043C\u0435\u043D\u0438"}};var rn=()=>[0,1];function an(n,t){if(n&1&&(Ft(0),a(1,"h3"),d(2),m(3,"date"),c(),$t()),n&2){let r=t.ngIf,e=f(3);s(2),h(" ",Nt(3,1,e.resultDate.date,r.dateFormat,void 0,r.localize)," ")}}function sn(n,t){if(n&1&&(a(0,"ion-chip",6),y(1,"ion-icon",9),a(2,"ion-label"),d(3),m(4,"localize"),c()()),n&2){let r=f(3);s(3),h(" ",_(4,1,r.ResultViewLocalize.NoTimeOverlap)," ")}}function ln(n,t){if(n&1&&(a(0,"ion-chip",7),y(1,"ion-icon",10),a(2,"ion-label"),d(3),m(4,"date"),m(5,"date"),c()()),n&2){let r=f(3);u("color",r.Helpers.getColorByType(r.resultDate.voteType)),s(),u("name",r.Helpers.getIconByType(r.resultDate.voteType)),s(2),j(" ",r.resultDate.start?O(4,4,r.resultDate.start,"HH:mm"):"00:00"," - ",r.resultDate.end?O(5,7,r.resultDate.end,"HH:mm"):"23:59"," ")}}function cn(n,t){if(n&1&&(a(0,"ion-text",11),d(1),c()),n&2){let r=f().$implicit;s(),h(" ",r.username?"@"+r.username:r.fullName," ")}}function pn(n,t){if(n&1&&d(0),n&2){let r=f().$implicit;h(" ",r.fullName," ")}}function mn(n,t){if(n&1&&(a(0,"ion-label"),$(1,cn,2,1,"ion-text",11)(2,pn,1,1),c()),n&2){let r=t.$implicit,e=f(3);s(),A(e.timeModeIndexes.has(r.index)?1:2)}}function dn(n,t){if(n&1&&(a(0,"ion-text",12),d(1),m(2,"date"),m(3,"date"),c()),n&2){let r=f().$implicit,e=f(3);u("color",e.Helpers.getColorByType(r.voteType)),s(),j(" ",r.start?O(2,3,r.start,"HH:mm"):"00:00"," - ",r.end?O(3,6,r.end,"HH:mm"):"23:59"," ")}}function un(n,t){if(n&1&&y(0,"ion-icon",13),n&2){let r=f().$implicit,e=f(3);u("color",e.Helpers.getColorByType(r.voteType))("icon",e.Helpers.getIconByType(r.voteType))}}function fn(n,t){if(n&1&&$(0,dn,4,9,"ion-text",12)(1,un,1,2,"ion-icon",13),n&2){let r=t.$implicit,e=f(3);A(e.timeModeIndexes.has(r.index)?0:1)}}function hn(n,t){if(n&1){let r=k();a(0,"div",4),F(1,an,4,6,"ng-container",5),m(2,"async"),$(3,sn,5,3,"ion-chip",6)(4,ln,6,10,"ion-chip",7),c(),a(5,"app-users-list",8),C("userClicked",function(i){x(r);let o=f(2);return b(o.toggleUserMode(i.user))})("searchFocused",function(i){x(r),f(2);let o=M(1);return b(o.backdropDismiss=!i)}),F(6,mn,3,1,"ng-template",null,1,Qe)(8,fn,2,1,"ng-template",null,2,Qe),c()}if(n&2){let r=f(2);s(),u("ngIf",_(2,4,r.dateFormat$)),s(2),A(r.resultDate.noTimeOverlap?3:4),s(2),u("users",r.resultDate.users)("clickable",!0)}}function gn(n,t){if(n&1&&$(0,hn,10,6),n&2){let r=f();A(r.resultDate?0:-1)}}var vt=(()=>{let t=class t{constructor(){this.ionModal=Le(me),this.timeModeIndexes=new Set,this.Helpers=xe,this.localizeService=v(ge),this.ResultViewLocalize=He,this.dateFormat$=this.localizeService.localizeLongDateFormat$}present(e){let i=this.ionModal();i&&(this.resultDate=e,e.users=e.users.map((o,l)=>Y(z({},o),{index:l})),i.present())}clearData(){this.resultDate=void 0,this.timeModeIndexes=new Set}toggleUserMode(e){let i=e.index;this.timeModeIndexes.has(i)?this.timeModeIndexes.delete(i):this.timeModeIndexes.add(i)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-result-date-info-modal"]],viewQuery:function(i,o){i&1&&Pe(o.ionModal,me,5),i&2&&Ve()},decls:3,vars:3,consts:[["modal",""],["altLabel",""],["end",""],[3,"ionModalDidDismiss","initialBreakpoint","breakpoints"],[1,"header"],[4,"ngIf"],["color","danger"],[1,"ion-activated",3,"color"],[3,"userClicked","searchFocused","users","clickable"],["name","alert-circle-outline"],[3,"name"],["color","medium"],[1,"user-time-info",3,"color"],[3,"color","icon"]],template:function(i,o){if(i&1){let l=k();a(0,"ion-modal",3,0),C("ionModalDidDismiss",function(){return x(l),b(o.clearData())}),F(2,gn,1,1,"ng-template"),c()}i&2&&u("initialBreakpoint",1)("breakpoints",oe(2,rn))},dependencies:[H,Oe,B,X,dt,ce,pe,U,ht,me,mt],styles:["ion-modal[_ngcontent-%COMP%]{--height: auto}ion-modal[_ngcontent-%COMP%]   app-users-list[_ngcontent-%COMP%]{height:52.25vh;padding:0 1rem 1rem}.header[_ngcontent-%COMP%]{padding:2rem 2rem .5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;column-gap:.5rem;row-gap:.25rem}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.header[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{pointer-events:none;margin:0}.user-time-info[_ngcontent-%COMP%]{font-size:.85rem;margin-bottom:-1px}"]});let n=t;return n})();var Ii=(()=>{let t=class t{get rootEl(){return this.elRef.nativeElement.shadowRoot}constructor(){this.data=v(Ce),this.elRef=v(se),this.rootObs=new MutationObserver(()=>{let e=this.rootEl.querySelectorAll("button.calendar-day");this.dateButtons$.next(Array.from(e))}),this.dateButtons$=new Ne(1),this.voteDateSelected$=this.dateButtons$.pipe(I(e=>{let i=e.map(o=>G(o,"click",{capture:!0}).pipe(V(l=>l.stopPropagation()),w(()=>o)));return W(...i)}),it((e,i)=>!this.noActionsAfterReset&&e===i),w(e=>this.getDateSelectedEvent(e)),w(e=>e.voteDate?e:void 0),ee(void 0),Ot(),V(([e,i])=>this.handleButtonStyles(e,i)),w(([e,i])=>i?.voteDate),V(()=>this.noActionsAfterReset=!1)),this.noActionsAfterReset=!0,this.dateSelected=W(this.voteDateSelected$,this.getResetDateEvent(this.dateButtons$),this.getResetDateEvent(he(this.data.filteredDates)))}ngAfterViewInit(){this.rootObs.observe(this.rootEl,{childList:!0,subtree:!0})}ngOnDestroy(){this.dateButtons$.complete(),this.rootObs.disconnect()}getResetDateEvent(e){return e.pipe(V(()=>this.noActionsAfterReset=!0),w(()=>{}))}getDateSelectedEvent(e){let i=Number(e.getAttribute("data-day")),o=Number(e.getAttribute("data-month")),l=Number(e.getAttribute("data-year")),p=new Date(l,o-1,i);return{prevBgColor:e.style.backgroundColor,prevColor:e.style.color,voteDate:this.data.getVoteDate(p),buttonEl:e}}handleButtonStyles(e,i){if(e&&!this.noActionsAfterReset){let o=e.buttonEl;o.style.backgroundColor=e.prevBgColor,o.style.color=e.prevColor}if(i){let o=i.buttonEl;o.style.backgroundColor=o.style.color,o.style.color="var(--ion-color-contrast)"}}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=R({type:t,selectors:[["","appResultViewCalendarPicker",""]],outputs:{dateSelected:"dateSelected"}});let n=t;return n})();function _n(n,t){if(n&1){let r=k();a(0,"div",4)(1,"ion-item",5),C("click",function(){let i=x(r).ngIf;f();let o=M(6);return b(o.present(i))}),y(2,"ion-icon",6),a(3,"ion-label"),d(4),m(5,"date"),c(),a(6,"ion-note",7),d(7),m(8,"localizeMany"),c()()()}if(n&2){let r=t.ngIf,e=f();s(2),u("color",r.noTimeOverlap?"danger":e.Helpers.getColorByType(r.voteType))("name",e.Helpers.getIconByType(r.voteType)),s(2),h(" ",O(5,5,r.date,"dd.MM.yyyy")," "),s(3),j(" ",r.users.length," ",O(8,8,e.ResultViewLocalize.Member,r.users.length)," ")}}var Ti=(()=>{let t=class t{constructor(){this.minDate=D(),this.maxDate=D(),this.ionDateComponent=Le(fe),this.data=v(Ce),this.Helpers=xe,this.ResultViewLocalize=He,this.selectedDate=E(void 0),this.localizeService=v(ge),this.localizeFormat$=this.localizeService.localizationWithFormat$,ot(()=>{let e=this.ionDateComponent(),i=this.data.filteredDates();if(e)if(i.length===0){e.highlightedDates=[];return}else{let o=(0,Si.groupBy)(i,"voteType"),l=o[S.Ready]??[],p=o[S.Maybe]??[],g=o[S.Time]??[];e.highlightedDates=[...l.map(P=>({date:this.data.formatVoteDate(P.date),textColor:"var(--ready-text-color)",backgroundColor:"var(--ready-bg-color)"})),...p.map(P=>({date:this.data.formatVoteDate(P.date),textColor:"var(--maybe-text-color)",backgroundColor:"var(--maybe-bg-color)"})),...g.map(P=>({date:this.data.formatVoteDate(P.date),textColor:"var(--time-text-color)",backgroundColor:"var(--time-bg-color)"}))]}else return})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-result-view-calendar"]],viewQuery:function(i,o){i&1&&Pe(o.ionDateComponent,fe,5),i&2&&Ve()},inputs:{minDate:[1,"minDate"],maxDate:[1,"maxDate"]},decls:7,vars:7,consts:[["infoModal",""],[1,"calendar-header"],["appResultViewCalendarPicker","","presentation","date","mode","ios",3,"dateSelected","firstDayOfWeek","min","max","locale"],["class","calendar-footer",4,"ngIf"],[1,"calendar-footer"],["button","","lines","none",3,"click"],["slot","start",3,"color","name"],["slot","end"]],template:function(i,o){if(i&1){let l=k();a(0,"div"),y(1,"div",1),a(2,"ion-datetime",2),m(3,"async"),C("dateSelected",function(g){return x(l),b(o.selectedDate.set(g))}),c(),F(4,_n,9,11,"div",3),c(),y(5,"app-result-date-info-modal",null,0)}i&2&&(s(2),u("firstDayOfWeek",1)("min",o.minDate()??void 0)("max",o.maxDate()??void 0)("locale",_(3,5,o.localizeFormat$)),s(2),u("ngIf",o.selectedDate()))},dependencies:[H,Oe,B,X,K,ue,ce,pe,_e,fe,vt,Ii],styles:[".calendar-header[_ngcontent-%COMP%]{background-color:var(--ion-color-light, #f4f5f8);border-top-left-radius:.5rem;border-top-right-radius:.5rem;width:100%;height:.5rem}ion-datetime[_ngcontent-%COMP%]:last-child{border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem}.calendar-footer[_ngcontent-%COMP%]{background-color:var(--ion-color-light, #f4f5f8);border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem;padding-bottom:.25rem}.calendar-footer[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}"],changeDetection:0});let n=t;return n})();function vn(n,t){if(n&1){let r=k();a(0,"ion-item",4),C("click",function(){let i=x(r).$implicit;f();let o=M(5);return b(o.present(i))}),y(1,"ion-icon",5),a(2,"ion-label"),d(3),m(4,"date"),c(),a(5,"ion-note",6),d(6),m(7,"localizeMany"),c()()}if(n&2){let r=t.$implicit,e=t.$index,i=t.$count,o=f();u("lines",e===i-1?"none":""),s(),u("color",r.noTimeOverlap?"danger":o.Helpers.getColorByType(r.voteType))("name",o.Helpers.getIconByType(r.voteType)),s(2),h(" ",O(4,6,r.date,"dd.MM.yyyy")," "),s(3),j(" ",r.users.length," ",O(7,9,o.ResultViewLocalize.Member,r.users.length)," ")}}function yn(n,t){if(n&1&&(a(0,"ion-item",3),y(1,"ion-icon",7),a(2,"ion-note",8),d(3),m(4,"localize"),c()()),n&2){let r=f();s(3),h(" ",_(4,1,r.ResultViewLocalize.NoData)," ")}}var ki=(()=>{let t=class t{constructor(){this.data=v(Ce),this.filteredDates=this.data.filteredDates,this.Helpers=xe,this.ResultViewLocalize=He}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-result-view-list"]],decls:6,vars:1,consts:[["infoModal",""],["mode","ios"],["button","",3,"lines"],["lines","none"],["button","",3,"click","lines"],["slot","start",3,"color","name"],["slot","end"],["slot","start","name","calendar-clear-outline","color","medium"],[1,"no-data"]],template:function(i,o){i&1&&(a(0,"ion-list",1),Te(1,vn,8,12,"ion-item",2,Se,!1,yn,5,3,"ion-item",3),c(),y(4,"app-result-date-info-modal",null,0)),i&2&&(s(),ke(o.filteredDates()))},dependencies:[H,B,X,de,K,ue,pe,U,_e,vt],styles:["ion-list[_ngcontent-%COMP%]{background:var(--ion-color-light, #f4f5f8);border-radius:.5rem;padding-block:.25rem}ion-item[_ngcontent-%COMP%]{--background: transparent}.no-data[_ngcontent-%COMP%]{font-size:.9rem;line-height:.9rem}"],changeDetection:0});let n=t;return n})();var Pi={Results:{en:"Results",ru:"\u0420\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B"},Vote:{en:"Vote",ru:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0434\u0430\u0442\u044B"}};function Cn(n,t){n&1&&y(0,"app-result-view-list")}function xn(n,t){if(n&1&&y(0,"app-result-view-calendar",16),n&2){f();let r=le(3);u("minDate",r==null?null:r.starts)("maxDate",r==null?null:r.ends)}}var il=(()=>{let t=class t{constructor(){this.eventId=D.required(),this.mainInfoComponent=Le(gt),this.alreadyInit=!1,this.ViewPick=re,this.VotePageLocalize=Pi}ionViewWillEnter(){this.alreadyInit?this.mainInfoComponent()?.refreshInfo():this.alreadyInit=!0}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=T({type:t,selectors:[["app-vote-event-page"]],viewQuery:function(i,o){i&1&&Pe(o.mainInfoComponent,gt,5),i&2&&Ve()},hostAttrs:[1,"app-page-inner"],inputs:{eventId:[1,"eventId"]},decls:30,vars:27,consts:[["eventMainInfo",""],["filters",""],["viewPicker",""],["resLoading","appFeatureLoad","result","appResultView"],[1,"ion-padding"],["appFeatureLoad","","placeholderOpacity","0.85",3,"eventId"],["mode","ios"],["value","vote","contentId","vote"],["value","info","contentId","info"],["id","vote"],[1,"segment-view-content"],["appFeatureLoad","","placeholderOpacity","0.75",3,"voteUpdated","eventId","minDate","maxDate"],["id","info"],[3,"disabled","maxMembers","maxOverlap"],[3,"refresh","disabled"],["appFeatureLoad","","placeholderOpacity","0.75","appResultView","",3,"viewPick","eventId","min","noMaybe","noTime","onlyWithMe","trimPast"],[3,"minDate","maxDate"]],template:function(i,o){if(i&1){let l=k();a(0,"ion-content",4),y(1,"app-event-main-info",5,0),je(3),a(4,"ion-segment",6)(5,"ion-segment-button",7)(6,"ion-label"),d(7),m(8,"localize"),c()(),a(9,"ion-segment-button",8)(10,"ion-label"),d(11),m(12,"localize"),c()()(),a(13,"ion-segment-view",6)(14,"ion-segment-content",9)(15,"div",10)(16,"app-vote-calendar",11),C("voteUpdated",function(g){x(l);let P=M(2),Q=M(27);return g.alreadyVoted||P.refreshUsers(),b(Q.refresh())}),c()()(),a(17,"ion-segment-content",12)(18,"div",10),y(19,"app-result-filters",13,1),m(21,"async"),a(22,"app-result-view-picker-control",14,2),m(24,"async"),C("refresh",function(){x(l);let g=M(27);return b(g.refresh())}),c(),a(25,"app-result-view-picker-container",15,3),$(28,Cn,1,0,"app-result-view-list")(29,xn,1,2,"app-result-view-calendar",16),c()()()()()}if(i&2){let l,p,g=M(2),P=M(20),Q=M(23),Ze=M(26),Vi=M(27);s(),u("eventId",o.eventId()),s(2);let et=Ee(g.info()),Pt=g.users();s(4),h(" ",_(8,19,o.VotePageLocalize.Vote)," "),s(4),h(" ",_(12,21,o.VotePageLocalize.Results)," "),s(5),u("eventId",o.eventId())("minDate",et==null?null:et.starts)("maxDate",et==null?null:et.ends),s(3),u("disabled",_(21,23,Ze.loading$))("maxMembers",(Pt==null?null:Pt.length)??0)("maxOverlap",(l=Vi.info())==null?null:l.maxOverlap),s(3),u("disabled",_(24,25,Ze.loading$)),s(3),u("viewPick",Q.value())("eventId",o.eventId())("min",P.membersCount())("noMaybe",P.noMaybe())("noTime",P.noTime())("onlyWithMe",P.onlyWithMe())("trimPast",P.trimPast()),s(3),A((p=Q.value())===o.ViewPick.List?28:p===o.ViewPick.Calendar?29:-1)}},dependencies:[ri,Yt,B,ce,U,xi,gt,fi,bi,Di,ki,Ti,Ce,ti,Gt,Jt,Xt,ve],styles:["ion-segment[_ngcontent-%COMP%]{margin:1rem 0 .5rem;background:var(--ion-color-light, #f4f5f8)}ion-segment-view[_ngcontent-%COMP%]{height:auto}ion-segment-content.hide[_ngcontent-%COMP%]{display:none}.segment-view-content[_ngcontent-%COMP%]{padding:.25rem .75rem 1.25rem;display:flex;flex-direction:column;gap:.75rem}"],changeDetection:0});let n=t;return n})();export{il as VoteEventPageComponent};
